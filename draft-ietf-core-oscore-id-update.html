<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Identifier Update for OSCORE</title>
<meta content="Rikard Höglund" name="author">
<meta content="Marco Tiloca" name="author">
<meta content="
       Two peers that communicate with the CoAP protocol can use the Object Security for Constrained RESTful Environments (OSCORE) protocol to protect their message exchanges end-to-end. To this end, the two peers share an OSCORE Security Context and a number of related identifiers. In particular, each of the two peers stores a Sender ID that identifies its own Sender Context within the Security Context, and a Recipient ID that identifies the Recipient Context associated with the other peer within the same Security Context. These identifiers are sent in plaintext within OSCORE-protected messages. Hence, they can be used to correlate messages exchanged between peers and track those peers, with consequent privacy implications. This document defines an OSCORE ID update procedure that two peers can use to update their OSCORE identifiers. This procedure can be run stand-alone or seamlessly integrated in an execution of the Key Update for OSCORE (KUDOS) procedure. 
    " name="description">
<meta content="xml2rfc 3.31.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-ietf-core-oscore-id-update-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.31.0
    Python 3.12.12
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.6
    lxml 5.3.1
    platformdirs 4.5.0
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.5
    wcwidth 0.2.14
-->
<link href="draft-ietf-core-oscore-id-update.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Identifier Update for OSCORE</td>
<td class="right">October 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Höglund &amp; Tiloca</td>
<td class="center">Expires 23 April 2026</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">CoRE Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-core-oscore-id-update-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-10-20" class="published">20 October 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2026-04-23">23 April 2026</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">R. Höglund</div>
<div class="org">RISE AB</div>
</div>
<div class="author">
      <div class="author-name">M. Tiloca</div>
<div class="org">RISE AB</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Identifier Update for OSCORE</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">Two peers that communicate with the CoAP protocol can use the Object Security for Constrained RESTful Environments (OSCORE) protocol to protect their message exchanges end-to-end. To this end, the two peers share an OSCORE Security Context and a number of related identifiers. In particular, each of the two peers stores a Sender ID that identifies its own Sender Context within the Security Context, and a Recipient ID that identifies the Recipient Context associated with the other peer within the same Security Context. These identifiers are sent in plaintext within OSCORE-protected messages. Hence, they can be used to correlate messages exchanged between peers and track those peers, with consequent privacy implications. This document defines an OSCORE ID update procedure that two peers can use to update their OSCORE identifiers. This procedure can be run stand-alone or seamlessly integrated in an execution of the Key Update for OSCORE (KUDOS) procedure.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-ietf-core-oscore-id-update/">https://datatracker.ietf.org/doc/draft-ietf-core-oscore-id-update/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        Constrained RESTful Environments (core) Working Group mailing list (<span><a href="mailto:core@ietf.org">mailto:core@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/core/">https://mailarchive.ietf.org/arch/browse/core/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/core/">https://www.ietf.org/mailman/listinfo/core/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/core-wg/oscore-id-update">https://github.com/core-wg/oscore-id-update</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 23 April 2026.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-update-of-oscore-sender-rec" class="internal xref">Update of OSCORE Sender/Recipient IDs</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-workflow-of-the-id-update-p" class="internal xref">Workflow of the ID Update Procedure</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.1">
                    <p id="section-toc.1-1.2.2.1.2.1.1" class="keepWithNext"><a href="#section-2.1.1" class="auto internal xref">2.1.1</a>.  <a href="#name-procedure-completion" class="internal xref">Procedure Completion</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-failure-of-the-id-update-pr" class="internal xref">Failure of the ID Update Procedure</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="auto internal xref">2.3</a>.  <a href="#name-the-recipient-id-option" class="internal xref">The Recipient-ID Option</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="auto internal xref">2.4</a>.  <a href="#name-the-recipient-id-ack-option" class="internal xref">The Recipient-ID-Ack Option</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4.2.1">
                    <p id="section-toc.1-1.2.2.4.2.1.1"><a href="#section-2.4.1" class="auto internal xref">2.4.1</a>.  <a href="#name-oscore-id-update-procedure-" class="internal xref">OSCORE ID Update Procedure Initiated with a Request Message</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4.2.2">
                    <p id="section-toc.1-1.2.2.4.2.2.1"><a href="#section-2.4.2" class="auto internal xref">2.4.2</a>.  <a href="#name-establishing-new-oscore-ide" class="internal xref">Establishing New OSCORE Identifiers Ahead of Network Migration</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4.2.3">
                    <p id="section-toc.1-1.2.2.4.2.3.1"><a href="#section-2.4.3" class="auto internal xref">2.4.3</a>.  <a href="#name-additional-actions-for-exec" class="internal xref">Additional Actions for Execution</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.5">
                <p id="section-toc.1-1.2.2.5.1"><a href="#section-2.5" class="auto internal xref">2.5</a>.  <a href="#name-preserving-observations-acr" class="internal xref">Preserving Observations Across ID Updates</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-coap-option-numbers-registr" class="internal xref">CoAP Option Numbers Registry</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-examples" class="internal xref">Examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-oscore-id-update-procedure-i" class="internal xref">OSCORE ID Update Procedure Initiated with a Response Message</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-failure-of-the-oscore-id-up" class="internal xref">Failure of the OSCORE ID Update Procedure Initiated with a Request Message</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-document-updates" class="internal xref">Document Updates</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#appendix-B.1" class="auto internal xref">B.1</a>.  <a href="#name-version-04-to-05" class="internal xref">Version -04 to -05</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#appendix-B.2" class="auto internal xref">B.2</a>.  <a href="#name-version-03-to-04" class="internal xref">Version -03 to -04</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#appendix-B.3" class="auto internal xref">B.3</a>.  <a href="#name-version-02-to-03" class="internal xref">Version -02 to -03</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#appendix-B.4" class="auto internal xref">B.4</a>.  <a href="#name-version-01-to-02" class="internal xref">Version -01 to -02</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a href="#appendix-B.5" class="auto internal xref">B.5</a>.  <a href="#name-version-00-to-01" class="internal xref">Version -00 to -01</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.6">
                <p id="section-toc.1-1.7.2.6.1"><a href="#appendix-B.6" class="auto internal xref">B.6</a>.  <a href="#name-version-00" class="internal xref">Version -00</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">When using the CoAP protocol <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>, two peers can use the Object Security for Constrained RESTful Environments (OSCORE) protocol to protect their message exchanges end-to-end. To this end, the two peers share an OSCORE Security Context and a number of related identifiers.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">As part of the shared Security Context, each peer stores one Sender Context identified by a Sender ID and used to protect its outgoing messages. Also, it stores a Recipient Context identified by a Recipient ID and used to unprotect the incoming messages from the other peer. That is, one's peer Sender ID (Recipient ID) is equal to the other peer's Recipient ID (Sender ID).<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">When receiving an OSCORE-protected message, the recipient peer uses its Recipient ID conveyed within the message or otherwise implied, in order to retrieve the correct Security Context and unprotect the message.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">These identifiers are sent in plaintext within OSCORE-protected messages and are immutable throughout the lifetime of a Security Context, even in case the two peers migrate to a different network or simply change their addressing information. Therefore, the identifiers can be used to correlate messages that the two peers exchange at different points in time or through different paths, hence allowing to track them with the consequent privacy implications.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">In order to address this issue, this document defines an OSCORE ID update procedure that two peers can use to update their OSCORE Sender and Recipient IDs. For instance, two peers may want to use this procedure before switching to a different network, in order to make it more difficult to understand that their communication is continuing in the new network.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">The OSCORE ID update procedure can be run stand-alone or seamlessly integrated in an execution of the Key Update for OSCORE (KUDOS) procedure <span>[<a href="#I-D.ietf-core-oscore-key-update" class="cite xref">I-D.ietf-core-oscore-key-update</a>]</span>.<a href="#section-1-6" class="pilcrow">¶</a></p>
<div id="terminology">
<section id="section-1.1">
        <h3 id="name-terminology">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.1-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">Readers are expected to be familiar with the terms and concepts related to CoAP <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>, Observe <span>[<a href="#RFC7641" class="cite xref">RFC7641</a>]</span>, CBOR <span>[<a href="#RFC8949" class="cite xref">RFC8949</a>]</span>, OSCORE <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>, and KUDOS <span>[<a href="#I-D.ietf-core-oscore-key-update" class="cite xref">I-D.ietf-core-oscore-key-update</a>]</span>.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="update-oscore-ids">
<section id="section-2">
      <h2 id="name-update-of-oscore-sender-rec">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-update-of-oscore-sender-rec" class="section-name selfRef">Update of OSCORE Sender/Recipient IDs</a>
      </h2>
<p id="section-2-1">This section defines the procedure that two peers can perform, in order to update the OSCORE Sender/Recipient IDs that they use in their shared OSCORE Security Context.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">When performing an update of OSCORE Sender/Recipient IDs, a peer provides its new intended OSCORE Recipient ID to the other peer, by means of the Recipient-ID Option defined in <a href="#sec-recipient-id-option" class="auto internal xref">Section 2.3</a>. Hereafter, this document refers to a message including the Recipient-ID Option as an "ID update (request/response) message". Furthermore, a peer uses the Recipient-ID-Ack Option to confirm the chosen Recipient ID of the other peer.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">This procedure can be initiated by either peer, i.e., the CoAP client or the CoAP server may start it by sending the first OSCORE ID update message.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">Furthermore, this procedure can be executed stand-alone, or instead seamlessly integrated in an execution of the KUDOS procedure for updating OSCORE keying material used in its FS mode (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-key-update-11#section-4" class="relref">Section 4</a> of [<a href="#I-D.ietf-core-oscore-key-update" class="cite xref">I-D.ietf-core-oscore-key-update</a>]</span>) or no-FS mode (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-key-update-11#section-4.5" class="relref">Section 4.5</a> of [<a href="#I-D.ietf-core-oscore-key-update" class="cite xref">I-D.ietf-core-oscore-key-update</a>]</span>).<a href="#section-2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-5.1">
          <p id="section-2-5.1.1">In the former stand-alone case, updating the OSCORE Sender/Recipient IDs effectively results in updating part of the current OSCORE Security Context.<a href="#section-2-5.1.1" class="pilcrow">¶</a></p>
<p id="section-2-5.1.2">
That is, both peers derive a new Sender Key, Recipient Key, and Common IV, as defined in <span><a href="https://rfc-editor.org/rfc/rfc8613#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>. Also, both peers re-initialize the Sender Sequence Number and the Replay Window accordingly, as defined in <span><a href="https://rfc-editor.org/rfc/rfc8613#section-3.2.2" class="relref">Section 3.2.2</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>. Since the same Master Secret is preserved, forward secrecy is not achieved.<a href="#section-2-5.1.2" class="pilcrow">¶</a></p>
<p id="section-2-5.1.3">
As defined in <a href="#id-update-additional-actions" class="auto internal xref">Section 2.4.3</a>, the two peers must take additional actions to ensure a safe execution of the OSCORE ID update procedure.<a href="#section-2-5.1.3" class="pilcrow">¶</a></p>
<p id="section-2-5.1.4">
The new OSCORE Sender/Recipient IDs <span class="bcp14">MUST NOT</span> be used with the OSCORE Security Context CTX_OLD, and <span class="bcp14">MUST NOT</span> be used with the temporary OSCORE Security Context CTX_TEMP used to protect the first KUDOS message of a KUDOS execution.<a href="#section-2-5.1.4" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-2-6">A peer <span class="bcp14">MUST NOT</span> initiate an OSCORE ID update procedure with another peer, if it has another such procedure ongoing with that other peer.<a href="#section-2-6" class="pilcrow">¶</a></p>
<p id="section-2-7">Upon receiving a valid, first ID update message, a peer <span class="bcp14">MUST</span> continue the procedure and send a following ID update message, except in the case any of the conditions for failing or aborting the procedure apply (see <a href="#update-failure" class="auto internal xref">Section 2.2</a>}).<a href="#section-2-7" class="pilcrow">¶</a></p>
<div id="workflow-of-the-id-update-procedure">
<section id="section-2.1">
        <h3 id="name-workflow-of-the-id-update-p">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-workflow-of-the-id-update-p" class="section-name selfRef">Workflow of the ID Update Procedure</a>
        </h3>
<p id="section-2.1-1">This section describes the workflow of the OSCORE ID Update procedure in detail.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">The procedure begins when either peer:<a href="#section-2.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-3.1">
            <p id="section-2.1-3.1.1">Sends a message including the Recipient-ID Option, or<a href="#section-2.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-3.2">
            <p id="section-2.1-3.2.1">Receives such a message from the other peer.<a href="#section-2.1-3.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.1-4">During the procedure a peer decides on a value of Recipient ID to offer to the other peer and use as value of the Recipient-ID Option, and continues offering that value until the procedure is completed.<a href="#section-2.1-4" class="pilcrow">¶</a></p>
<p id="section-2.1-5">Once the procedure has started a peer shall follow the instructions below:<a href="#section-2.1-5" class="pilcrow">¶</a></p>
<p id="section-2.1-6"><strong>Sending the Next Message</strong><a href="#section-2.1-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-7.1">
            <p id="section-2.1-7.1.1">The first messages sent using CTX_A, the current shared OSCORE Security Context, after the procedure has started must include the Recipient-ID Option, if this peer hasn't offered its Recipient ID already.<a href="#section-2.1-7.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-7.1.2.1">
                <p id="section-2.1-7.1.2.1.1">Note that this also informs the other peer of support for the ID update procedure.<a href="#section-2.1-7.1.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<p id="section-2.1-8"><strong>Acknowledgment</strong><a href="#section-2.1-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-9.1">
            <p id="section-2.1-9.1.1">If a peer has received a valid message from the other peer including the Recipient-ID Option, it must include the Recipient-ID-Ack Option in subsequent messages.<a href="#section-2.1-9.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-9.2">
            <p id="section-2.1-9.2.1">The value of Recipient-ID-Ack Option, if used, should be the Recipient ID received from the other peer.<a href="#section-2.1-9.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.1-10"><strong>Sending Subsequent Messages</strong><a href="#section-2.1-10" class="pilcrow">¶</a></p>
<p id="section-2.1-11">A peer must send one message with the Recipient ID Option according to the following:<a href="#section-2.1-11" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-12.1">
            <p id="section-2.1-12.1.1">A local timer, REPEAT_TIMER, should be maintained during the procedure. It first starts when the procedure starts. It is <span class="bcp14">RECOMMENDED</span> that the initial time of REPEAT_TIMER is equal to MAX_TRANSMIT_WAIT (see <span><a href="https://rfc-editor.org/rfc/rfc7252#section-4.8.2" class="relref">Section 4.8.2</a> of [<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>).<a href="#section-2.1-12.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-12.1.2.1">
                <p id="section-2.1-12.1.2.1.1">If the timeout expires, the next sent message must include the Recipient ID option and, if applicable, the Recipient-ID-Ack Option with the last received Recipient ID. When that message is sent the timer REPEAT_TIMER restarts.<a href="#section-2.1-12.1.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<div id="procedure-completion">
<section id="section-2.1.1">
          <h4 id="name-procedure-completion">
<a href="#section-2.1.1" class="section-number selfRef">2.1.1. </a><a href="#name-procedure-completion" class="section-name selfRef">Procedure Completion</a>
          </h4>
<p id="section-2.1.1-1">The procedure concludes under one of the following conditions:<a href="#section-2.1.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1.1-2"><strong>Successful Confirmation</strong><a href="#section-2.1.1-2" class="pilcrow">¶</a></p>
<p id="section-2.1.1-3">The procedure succeeds if a peer has received and successfully verified at least three message from the other peer containing the Recipient-ID-Ack Option, and sent at least two messages containing the Recipient-ID-Ack Option. At this point:<a href="#section-2.1.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1.1-4.1">
              <p id="section-2.1.1-4.1.1">It is safe to delete CTX_A. This does not mean that CTX_A has to be deleted at this point.<a href="#section-2.1.1-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.1.1-4.2">
              <p id="section-2.1.1-4.2.1">CTX_B is now considered valid and can be used (e.g., following network migration).<a href="#section-2.1.1-4.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-2.1.1-5"><strong>Failure</strong><a href="#section-2.1.1-5" class="pilcrow">¶</a></p>
<p id="section-2.1.1-6">During the procedure a timer, ENDING_TIMER, is maintained and started when the procedure starts. The initial time of ENDING_TIMER should be at least 3 times bigger than the initial time of REPEAT_TIMER. If the ENDING_TIMER expires, and the procedure times out without confirmation:<a href="#section-2.1.1-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1.1-7.1">
              <p id="section-2.1.1-7.1.1">The offered Recipient ID must be discarded and added to the list of IDs to prevent reuse.<a href="#section-2.1.1-7.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="update-failure">
<section id="section-2.2">
        <h3 id="name-failure-of-the-id-update-pr">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-failure-of-the-id-update-pr" class="section-name selfRef">Failure of the ID Update Procedure</a>
        </h3>
<p id="section-2.2-1">The following section describes cases where the OSCORE ID update procedure fails, or must to be aborted by one of the peers.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2-2">Upon receiving a valid first ID update message, a peer <span class="bcp14">MUST</span> abort the ID update procedure, in the following case:<a href="#section-2.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2-3.1">
            <p id="section-2.2-3.1.1">The received ID update message is not a KUDOS message (i.e., the OSCORE ID update procedure is being performed stand-alone) and the peer has no eligible Recipient ID to offer (see <a href="#id-update-additional-actions" class="auto internal xref">Section 2.4.3</a>).<a href="#section-2.2-3.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.2-4">Upon receiving a valid ID update message, a peer <span class="bcp14">MUST</span> abort the ID update procedure, in the following case:<a href="#section-2.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2-5.1">
            <p id="section-2.2-5.1.1">The received ID update message contains a Recipient-ID option with a length that exceeds the maximum length of OSCORE Sender/Recipient IDs for the AEAD algorithm in use for the OSCORE Security Context shared between the peers. This is the case when the length of the Recipient-ID option exceeds the length of the AEAD nonce minus 6 (see <span><a href="https://rfc-editor.org/rfc/rfc8613#section-3.3" class="relref">Section 3.3</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>).<a href="#section-2.2-5.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.2-6">If, after receiving an ID update message as CoAP request, a peer aborts the ID update procedure, the peer <span class="bcp14">MUST</span> also reply to the received ID update request message with a protected 5.03 (Service Unavailable) error response. The error response <span class="bcp14">MUST NOT</span> include the Recipient-ID Option, and its diagnostic payload <span class="bcp14">MAY</span> provide additional information. When receiving the error response, the peer terminates the OSCORE IDs procedure as failed.<a href="#section-2.2-6" class="pilcrow">¶</a></p>
<p id="section-2.2-7">When the OSCORE ID update procedure is integrated into the execution of the KUDOS procedure, it is possible that the KUDOS procedure succeeds while the OSCORE ID update procedure fails. In such case, the peers continue their communications using the newly derived OSCORE Security Context CTX_NEW obtained from the KUDOS procedure, and still use the old Sender and Recipient IDs. That is, any Recipient IDs conveyed in the exchanged Recipient-ID Options is not considered.<a href="#section-2.2-7" class="pilcrow">¶</a></p>
<p id="section-2.2-8">Conversely, the OSCORE ID update procedure may succeed while the KUDOS procedure fails. As long as the peers have exchanged a pair of OSCORE-protected request and response that conveyed their desired new Recipient IDs in the Recipient-ID Option, the peers start using those IDs in their communications.<a href="#section-2.2-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-recipient-id-option">
<section id="section-2.3">
        <h3 id="name-the-recipient-id-option">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-the-recipient-id-option" class="section-name selfRef">The Recipient-ID Option</a>
        </h3>
<p id="section-2.3-1">The Recipient ID-Option defined in this section has the properties summarized in <a href="#_table-recipient-id-option" class="auto internal xref">Table 1</a>, which extends Table 4 of <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>. That is, the option is elective, safe to forward, part of the cache key, and not repeatable.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<span id="name-the-recipient-id-option-ccr"></span><div id="_table-recipient-id-option">
<table class="center" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-the-recipient-id-option-ccr" class="selfRef">The Recipient-ID Option. C=Critical, U=Unsafe, N=NoCacheKey, R=Repeatable</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">No.</th>
              <th class="text-left" rowspan="1" colspan="1">C</th>
              <th class="text-left" rowspan="1" colspan="1">U</th>
              <th class="text-left" rowspan="1" colspan="1">N</th>
              <th class="text-left" rowspan="1" colspan="1">R</th>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Format</th>
              <th class="text-left" rowspan="1" colspan="1">Length</th>
              <th class="text-left" rowspan="1" colspan="1">Default</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">TBD24</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">Recipient-ID</td>
              <td class="text-left" rowspan="1" colspan="1">opaque</td>
              <td class="text-left" rowspan="1" colspan="1">any</td>
              <td class="text-left" rowspan="1" colspan="1">(none)</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-2.3-3">Note to RFC Editor: Following the registration of the CoAP Option Number 24, please replace "TBD24" with "24" in the figure above. Then, please delete this paragraph.<a href="#section-2.3-3" class="pilcrow">¶</a></p>
<p id="section-2.3-4">The option value can have an arbitrary length, including zero length to indicate intent to use the empty string as Recipient ID. Implementations can limit its length to that of the longest supported Recipient ID.<a href="#section-2.3-4" class="pilcrow">¶</a></p>
<p id="section-2.3-5">This document particularly defines how this option is used in messages protected with OSCORE. That is, when the option is included in an outgoing message, the option value specifies the new OSCORE Recipient ID that the sender endpoint intends to use with the other endpoint sharing the OSCORE Security Context.<a href="#section-2.3-5" class="pilcrow">¶</a></p>
<p id="section-2.3-6">Therefore, the maximum length of the option value is equal to the maximum length of OSCORE Sender/Recipient IDs. As defined in <span><a href="https://rfc-editor.org/rfc/rfc8613#section-3.3" class="relref">Section 3.3</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>, this is determined by the size of the AEAD nonce of the used AEAD Algorithm in the OSCORE Security Context.<a href="#section-2.3-6" class="pilcrow">¶</a></p>
<p id="section-2.3-7">If the length of the Recipient ID included in the Recipient-ID option is zero, the option value <span class="bcp14">SHALL</span> be empty (Option Length = 0).<a href="#section-2.3-7" class="pilcrow">¶</a></p>
<p id="section-2.3-8">The Recipient-ID Option is of class E in terms of OSCORE processing (see <span><a href="https://rfc-editor.org/rfc/rfc8613#section-4.1" class="relref">Section 4.1</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>).<a href="#section-2.3-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-recipient-id-ack-option">
<section id="section-2.4">
        <h3 id="name-the-recipient-id-ack-option">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-the-recipient-id-ack-option" class="section-name selfRef">The Recipient-ID-Ack Option</a>
        </h3>
<p id="section-2.4-1">The Recipient ID-Ack-Option defined in this section has the properties summarized in <a href="#_table-recipient-id-ack-option" class="auto internal xref">Table 2</a>, which extends Table 4 of <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>. That is, the option is elective, safe to forward, part of the cache key, and not repeatable.<a href="#section-2.4-1" class="pilcrow">¶</a></p>
<span id="name-the-recipient-id-ack-option-"></span><div id="_table-recipient-id-ack-option">
<table class="center" id="table-2">
          <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-the-recipient-id-ack-option-" class="selfRef">The Recipient-ID-Ack Option. C=Critical, U=Unsafe, N=NoCacheKey, R=Repeatable</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">No.</th>
              <th class="text-left" rowspan="1" colspan="1">C</th>
              <th class="text-left" rowspan="1" colspan="1">U</th>
              <th class="text-left" rowspan="1" colspan="1">N</th>
              <th class="text-left" rowspan="1" colspan="1">R</th>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Format</th>
              <th class="text-left" rowspan="1" colspan="1">Length</th>
              <th class="text-left" rowspan="1" colspan="1">Default</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">TBD32</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">Recipient-ID-Ack</td>
              <td class="text-left" rowspan="1" colspan="1">opaque</td>
              <td class="text-left" rowspan="1" colspan="1">any</td>
              <td class="text-left" rowspan="1" colspan="1">(none)</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-2.4-3">Note to RFC Editor: Following the registration of the CoAP Option Number 32, please replace "TBD32" with "32" in the figure above. Then, please delete this paragraph.<a href="#section-2.4-3" class="pilcrow">¶</a></p>
<p id="section-2.4-4">This document particularly defines how this option is used in messages protected with OSCORE. That is, when the option is included in an outgoing message, the option value confirms the new OSCORE Recipient ID that the recipient endpoint has chosen for this sender endpoint.<a href="#section-2.4-4" class="pilcrow">¶</a></p>
<p id="section-2.4-5">The Recipient-ID-Ack Option is of class E in terms of OSCORE processing (see <span><a href="https://rfc-editor.org/rfc/rfc8613#section-4.1" class="relref">Section 4.1</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>).<a href="#section-2.4-5" class="pilcrow">¶</a></p>
<div id="example-client-initiated-id-update">
<section id="section-2.4.1">
          <h4 id="name-oscore-id-update-procedure-">
<a href="#section-2.4.1" class="section-number selfRef">2.4.1. </a><a href="#name-oscore-id-update-procedure-" class="section-name selfRef">OSCORE ID Update Procedure Initiated with a Request Message</a>
          </h4>
<p id="section-2.4.1-1"><a href="#fig-id-update-client-init" class="auto internal xref">Figure 1</a> shows an example of the OSCORE ID update procedure, run stand-alone and initiated by the client sending a request message. On each peer, SID and RID denote the OSCORE Sender ID and Recipient ID of that peer, respectively. An example where the server initiates the procedure is shown in <a href="#example-server-initiated-id-update" class="auto internal xref">Appendix A.1</a>.<a href="#section-2.4.1-1" class="pilcrow">¶</a></p>
<span id="name-example-of-the-oscore-id-up"></span><div id="fig-id-update-client-init">
<figure id="figure-1">
            <div id="section-2.4.1-2.1">
              <div class="alignCenter art-svg artwork" id="section-2.4.1-2.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="1872" width="496" viewBox="0 0 496 1872" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 104,48 L 104,1856" fill="none" stroke="black"></path>
                  <path d="M 392,48 L 392,1856" fill="none" stroke="black"></path>
                  <path d="M 112,160 L 384,160" fill="none" stroke="black"></path>
                  <path d="M 112,368 L 384,368" fill="none" stroke="black"></path>
                  <path d="M 112,608 L 384,608" fill="none" stroke="black"></path>
                  <path d="M 112,816 L 384,816" fill="none" stroke="black"></path>
                  <path d="M 112,1008 L 384,1008" fill="none" stroke="black"></path>
                  <path d="M 112,1216 L 384,1216" fill="none" stroke="black"></path>
                  <path d="M 112,1456 L 384,1456" fill="none" stroke="black"></path>
                  <path d="M 112,1728 L 384,1728" fill="none" stroke="black"></path>
                  <polygon class="arrowhead" points="392,1456 380,1450.4 380,1461.6" fill="black" transform="rotate(0,384,1456)"></polygon>
                  <polygon class="arrowhead" points="392,1008 380,1002.4 380,1013.6" fill="black" transform="rotate(0,384,1008)"></polygon>
                  <polygon class="arrowhead" points="392,608 380,602.4 380,613.6" fill="black" transform="rotate(0,384,608)"></polygon>
                  <polygon class="arrowhead" points="392,160 380,154.4 380,165.6" fill="black" transform="rotate(0,384,160)"></polygon>
                  <polygon class="arrowhead" points="120,1728 108,1722.4 108,1733.6" fill="black" transform="rotate(180,112,1728)"></polygon>
                  <polygon class="arrowhead" points="120,1216 108,1210.4 108,1221.6" fill="black" transform="rotate(180,112,1216)"></polygon>
                  <polygon class="arrowhead" points="120,816 108,810.4 108,821.6" fill="black" transform="rotate(180,112,816)"></polygon>
                  <polygon class="arrowhead" points="120,368 108,362.4 108,373.6" fill="black" transform="rotate(180,112,368)"></polygon>
                  <g class="text">
                    <text x="108" y="36">Client</text>
                    <text x="388" y="36">Server</text>
                    <text x="24" y="68">CTX_A</text>
                    <text x="56" y="68">{</text>
                    <text x="424" y="68">CTX_A</text>
                    <text x="456" y="68">{</text>
                    <text x="24" y="84">SID</text>
                    <text x="48" y="84">=</text>
                    <text x="76" y="84">0x01</text>
                    <text x="424" y="84">SID</text>
                    <text x="448" y="84">=</text>
                    <text x="476" y="84">0x00</text>
                    <text x="24" y="100">RID</text>
                    <text x="48" y="100">=</text>
                    <text x="76" y="100">0x00</text>
                    <text x="424" y="100">RID</text>
                    <text x="448" y="100">=</text>
                    <text x="476" y="100">0x01</text>
                    <text x="8" y="116">}</text>
                    <text x="408" y="116">}</text>
                    <text x="232" y="148">Request</text>
                    <text x="276" y="148">#1</text>
                    <text x="32" y="164">Protect</text>
                    <text x="424" y="164">/temp</text>
                    <text x="20" y="180">with</text>
                    <text x="64" y="180">CTX_A</text>
                    <text x="140" y="180">OSCORE</text>
                    <text x="176" y="180">{</text>
                    <text x="136" y="196">...</text>
                    <text x="140" y="212">kid:</text>
                    <text x="180" y="212">0x01</text>
                    <text x="428" y="212">Verify</text>
                    <text x="120" y="228">}</text>
                    <text x="420" y="228">with</text>
                    <text x="464" y="228">CTX_A</text>
                    <text x="152" y="244">Encrypted</text>
                    <text x="224" y="244">Payload</text>
                    <text x="264" y="244">{</text>
                    <text x="136" y="260">...</text>
                    <text x="176" y="276">Recipient-ID:</text>
                    <text x="252" y="276">0x42</text>
                    <text x="136" y="292">...</text>
                    <text x="168" y="308">Application</text>
                    <text x="248" y="308">Payload</text>
                    <text x="120" y="324">}</text>
                    <text x="236" y="356">Response</text>
                    <text x="284" y="356">#1</text>
                    <text x="432" y="372">Protect</text>
                    <text x="140" y="388">OSCORE</text>
                    <text x="176" y="388">{</text>
                    <text x="420" y="388">with</text>
                    <text x="464" y="388">CTX_A</text>
                    <text x="136" y="404">...</text>
                    <text x="28" y="420">Verify</text>
                    <text x="120" y="420">}</text>
                    <text x="20" y="436">with</text>
                    <text x="64" y="436">CTX_A</text>
                    <text x="152" y="436">Encrypted</text>
                    <text x="224" y="436">Payload</text>
                    <text x="264" y="436">{</text>
                    <text x="136" y="452">...</text>
                    <text x="176" y="468">Recipient-ID:</text>
                    <text x="252" y="468">0x78</text>
                    <text x="192" y="484">Recipient-ID-Ack:</text>
                    <text x="284" y="484">0x42</text>
                    <text x="136" y="500">...</text>
                    <text x="168" y="516">Application</text>
                    <text x="248" y="516">Payload</text>
                    <text x="120" y="532">}</text>
                    <text x="232" y="596">Request</text>
                    <text x="276" y="596">#2</text>
                    <text x="32" y="612">Protect</text>
                    <text x="424" y="612">/temp</text>
                    <text x="20" y="628">with</text>
                    <text x="64" y="628">CTX_A</text>
                    <text x="140" y="628">OSCORE</text>
                    <text x="176" y="628">{</text>
                    <text x="136" y="644">...</text>
                    <text x="140" y="660">kid:</text>
                    <text x="180" y="660">0x01</text>
                    <text x="428" y="660">Verify</text>
                    <text x="120" y="676">}</text>
                    <text x="420" y="676">with</text>
                    <text x="464" y="676">CTX_A</text>
                    <text x="152" y="692">Encrypted</text>
                    <text x="224" y="692">Payload</text>
                    <text x="264" y="692">{</text>
                    <text x="136" y="708">...</text>
                    <text x="192" y="724">Recipient-ID-Ack:</text>
                    <text x="284" y="724">0x78</text>
                    <text x="136" y="740">...</text>
                    <text x="168" y="756">Application</text>
                    <text x="248" y="756">Payload</text>
                    <text x="120" y="772">}</text>
                    <text x="236" y="804">Response</text>
                    <text x="284" y="804">#2</text>
                    <text x="432" y="820">Protect</text>
                    <text x="140" y="836">OSCORE</text>
                    <text x="176" y="836">{</text>
                    <text x="420" y="836">with</text>
                    <text x="464" y="836">CTX_A</text>
                    <text x="136" y="852">...</text>
                    <text x="28" y="868">Verify</text>
                    <text x="120" y="868">}</text>
                    <text x="20" y="884">with</text>
                    <text x="64" y="884">CTX_A</text>
                    <text x="152" y="884">Encrypted</text>
                    <text x="224" y="884">Payload</text>
                    <text x="264" y="884">{</text>
                    <text x="136" y="900">...</text>
                    <text x="192" y="916">Recipient-ID-Ack:</text>
                    <text x="284" y="916">0x42</text>
                    <text x="168" y="932">Application</text>
                    <text x="248" y="932">Payload</text>
                    <text x="120" y="948">}</text>
                    <text x="232" y="996">Request</text>
                    <text x="276" y="996">#3</text>
                    <text x="32" y="1012">Protect</text>
                    <text x="424" y="1012">/temp</text>
                    <text x="20" y="1028">with</text>
                    <text x="64" y="1028">CTX_A</text>
                    <text x="140" y="1028">OSCORE</text>
                    <text x="176" y="1028">{</text>
                    <text x="136" y="1044">...</text>
                    <text x="140" y="1060">kid:</text>
                    <text x="180" y="1060">0x01</text>
                    <text x="428" y="1060">Verify</text>
                    <text x="120" y="1076">}</text>
                    <text x="420" y="1076">with</text>
                    <text x="464" y="1076">CTX_A</text>
                    <text x="152" y="1092">Encrypted</text>
                    <text x="224" y="1092">Payload</text>
                    <text x="264" y="1092">{</text>
                    <text x="136" y="1108">...</text>
                    <text x="192" y="1124">Recipient-ID-Ack:</text>
                    <text x="284" y="1124">0x78</text>
                    <text x="136" y="1140">...</text>
                    <text x="168" y="1156">Application</text>
                    <text x="248" y="1156">Payload</text>
                    <text x="120" y="1172">}</text>
                    <text x="236" y="1204">Response</text>
                    <text x="284" y="1204">#3</text>
                    <text x="432" y="1220">Protect</text>
                    <text x="140" y="1236">OSCORE</text>
                    <text x="176" y="1236">{</text>
                    <text x="420" y="1236">with</text>
                    <text x="464" y="1236">CTX_A</text>
                    <text x="136" y="1252">...</text>
                    <text x="28" y="1268">Verify</text>
                    <text x="120" y="1268">}</text>
                    <text x="20" y="1284">with</text>
                    <text x="64" y="1284">CTX_A</text>
                    <text x="152" y="1284">Encrypted</text>
                    <text x="224" y="1284">Payload</text>
                    <text x="264" y="1284">{</text>
                    <text x="136" y="1300">...</text>
                    <text x="192" y="1316">Recipient-ID-Ack:</text>
                    <text x="284" y="1316">0x42</text>
                    <text x="168" y="1332">Application</text>
                    <text x="248" y="1332">Payload</text>
                    <text x="120" y="1348">}</text>
                    <text x="20" y="1380">Safe</text>
                    <text x="52" y="1380">to</text>
                    <text x="32" y="1396">discard</text>
                    <text x="24" y="1412">CTX_A</text>
                    <text x="232" y="1444">Request</text>
                    <text x="276" y="1444">#4</text>
                    <text x="32" y="1460">Protect</text>
                    <text x="424" y="1460">/temp</text>
                    <text x="20" y="1476">with</text>
                    <text x="64" y="1476">CTX_A</text>
                    <text x="140" y="1476">OSCORE</text>
                    <text x="176" y="1476">{</text>
                    <text x="136" y="1492">...</text>
                    <text x="140" y="1508">kid:</text>
                    <text x="180" y="1508">0x01</text>
                    <text x="428" y="1508">Verify</text>
                    <text x="120" y="1524">}</text>
                    <text x="420" y="1524">with</text>
                    <text x="464" y="1524">CTX_A</text>
                    <text x="152" y="1540">Encrypted</text>
                    <text x="224" y="1540">Payload</text>
                    <text x="264" y="1540">{</text>
                    <text x="136" y="1556">...</text>
                    <text x="192" y="1572">Recipient-ID-Ack:</text>
                    <text x="284" y="1572">0x78</text>
                    <text x="136" y="1588">...</text>
                    <text x="168" y="1604">Application</text>
                    <text x="248" y="1604">Payload</text>
                    <text x="120" y="1620">}</text>
                    <text x="420" y="1652">Safe</text>
                    <text x="452" y="1652">to</text>
                    <text x="432" y="1668">discard</text>
                    <text x="424" y="1684">CTX_A</text>
                    <text x="236" y="1716">Response</text>
                    <text x="284" y="1716">#4</text>
                    <text x="432" y="1732">Protect</text>
                    <text x="140" y="1748">OSCORE</text>
                    <text x="176" y="1748">{</text>
                    <text x="420" y="1748">with</text>
                    <text x="464" y="1748">CTX_A</text>
                    <text x="136" y="1764">...</text>
                    <text x="28" y="1780">Verify</text>
                    <text x="120" y="1780">}</text>
                    <text x="20" y="1796">with</text>
                    <text x="64" y="1796">CTX_A</text>
                    <text x="152" y="1796">Encrypted</text>
                    <text x="224" y="1796">Payload</text>
                    <text x="264" y="1796">{</text>
                    <text x="136" y="1812">...</text>
                    <text x="168" y="1828">Application</text>
                    <text x="248" y="1828">Payload</text>
                    <text x="120" y="1844">}</text>
                  </g>
                </svg><a href="#section-2.4.1-2.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-example-of-the-oscore-id-up" class="selfRef">Example of the OSCORE ID update procedure initiated with a request message</a>
            </figcaption></figure>
</div>
<p id="section-2.4.1-3">Before the OSCORE ID update procedure starts, the client (the server) shares with the server (the client) an OSCORE Security Context CTX_A with Sender ID 0x01 (0x00) and Recipient ID 0x00 (0x01).<a href="#section-2.4.1-3" class="pilcrow">¶</a></p>
<p id="section-2.4.1-4">When starting the OSCORE ID update procedure, the client determines its new intended OSCORE Recipient ID 0x42. Then, the client prepares a CoAP request targeting an application resource at the server. The request includes the Recipient-ID Option, with value the client's new Recipient ID 0x42.<a href="#section-2.4.1-4" class="pilcrow">¶</a></p>
<p id="section-2.4.1-5">The client protects the request with CTX_A, i.e., by using the keying material derived from the client's current Sender ID 0x01. The protected request specifies the client's current Sender ID 0x01 in the 'kid' field of the OSCORE Option. After that, the client sends the request to the server as Request #1.<a href="#section-2.4.1-5" class="pilcrow">¶</a></p>
<p id="section-2.4.1-6">Upon receiving, decrypting, and successfully verifying the OSCORE message Request #1, the server retrieves the value 0x42 from the Recipient-ID Option, and determines its new intended OSCORE Recipient ID 0x78. Then, the server prepares a CoAP response including the Recipient-ID Option, with value the server's new Recipient ID 0x78, and the Recipient-ID-Ack Option, with value the client's offered Recipient ID 0x42.<a href="#section-2.4.1-6" class="pilcrow">¶</a></p>
<p id="section-2.4.1-7">The server protects the response with CTX_A, i.e., by using the keying material derived from the server's current Sender ID 0x00. After that, the server sends the response to the client.<a href="#section-2.4.1-7" class="pilcrow">¶</a></p>
<p id="section-2.4.1-8">Next, the client sends the OSCORE message Request #2, which is protected with CTX_A and includes the Recipient-ID-Ack Option, with value the server's offered Recipient ID 0x78.<a href="#section-2.4.1-8" class="pilcrow">¶</a></p>
<p id="section-2.4.1-9">From this point, following messages exchanges between the peers will include the Recipient-ID-Ack Option. A peer will only stop including that option when it has verified 3 messages from the other peer containing the Recipient-ID-Ack Option.<a href="#section-2.4.1-9" class="pilcrow">¶</a></p>
<p id="section-2.4.1-10">Upon receiving, decrypting, and successfully verifying the OSCORE message Response #3, the client considers 0x78 and 0x42 as the new Sender ID and Recipient ID to use when deriving CTX_B. Practically, the client can install a new OSCORE Security Context CTX_B where: i) its Sender ID and Recipient ID are 0x78 and 0x42, respectively; ii) the Sender Sequence Number and the Replay Window are re-initialized (see <span><a href="https://rfc-editor.org/rfc/rfc8613#section-3.2.2" class="relref">Section 3.2.2</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>); iii) anything else is like in the OSCORE Security Context CTX_A.<a href="#section-2.4.1-10" class="pilcrow">¶</a></p>
<p id="section-2.4.1-11">Upon receiving, decrypting, and successfully verifying the OSCORE message Request #4, the server considers 0x42 and 0x78 as its new Sender ID and Recipient ID to use for CTX_B. Practically, the server installs a new OSCORE Security Context CTX_A where: i) its Sender ID and Recipient ID are 0x42 and 0x78, respectively; ii) the Sender Sequence Number and the Replay Window are re-initialized (see <span><a href="https://rfc-editor.org/rfc/rfc8613#section-3.2.2" class="relref">Section 3.2.2</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>); iii) anything else is like in the OSCORE Security Context CTX_A.<a href="#section-2.4.1-11" class="pilcrow">¶</a></p>
<p id="section-2.4.1-12">At this point both client and server are in a position to derive CTX_B already, or wait to do it. Regardless they are both able to start using CTX_B, e.g., after network migration.<a href="#section-2.4.1-12" class="pilcrow">¶</a></p>
</section>
</div>
<div id="new-identifiers-before-migration">
<section id="section-2.4.2">
          <h4 id="name-establishing-new-oscore-ide">
<a href="#section-2.4.2" class="section-number selfRef">2.4.2. </a><a href="#name-establishing-new-oscore-ide" class="section-name selfRef">Establishing New OSCORE Identifiers Ahead of Network Migration</a>
          </h4>
<p id="section-2.4.2-1">Peers may use the OSCORE ID update procedure to establish new OSCORE IDs in advance of a network change. However, peers <span class="bcp14">SHOULD NOT</span> begin using these new identifiers on the current network prior to network migration. Using a new identifier on the old network, or using the old identifiers on the new network, would allow observers to correlate activity across networks, defeating the unlinkability that updating the OSCORE IDs is intended to provide. To be effective, new identifiers <span class="bcp14">SHOULD</span> only be used for sending OSCORE protected messages once the network migration is completed. Establishing new OSCORE IDs ahead of time ensures that migration can proceed without delay, but care must be taken to ensure that premature use of the identifiers does not enable linkability.<a href="#section-2.4.2-1" class="pilcrow">¶</a></p>
<p id="section-2.4.2-2">To accomplish this, the peers execute the ID update procedure as normal, with the following difference: the peers must not begin using the OSCORE Security Context CTX_B until after the network migration has taken place. Thus, both peers will be in the position to derive CTX_B, but will not transition to use it until the first request protected with CTX_B is transmitted in the new network, that is after network migration. Note that peers may want to retain CTX_A to have available for migration back to the old network.<a href="#section-2.4.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="id-update-additional-actions">
<section id="section-2.4.3">
          <h4 id="name-additional-actions-for-exec">
<a href="#section-2.4.3" class="section-number selfRef">2.4.3. </a><a href="#name-additional-actions-for-exec" class="section-name selfRef">Additional Actions for Execution</a>
          </h4>
<p id="section-2.4.3-1">After having experienced a loss of state, a peer <span class="bcp14">MUST NOT</span> participate in a stand-alone OSCORE ID update procedure with another peer, until having performed a full-fledged establishment/renewal of an OSCORE Security Context with the other peer (e.g., by running KUDOS <span>[<a href="#I-D.ietf-core-oscore-key-update" class="cite xref">I-D.ietf-core-oscore-key-update</a>]</span> or the authenticated key establishment protocol EDHOC <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>).<a href="#section-2.4.3-1" class="pilcrow">¶</a></p>
<p id="section-2.4.3-2">More precisely, a peer has experienced a loss of state if it cannot access the latest snapshot of the latest OSCORE Security Context CTX_OLD or the whole set of OSCORE Sender/Recipient IDs that have been used with the triplet (Master Secret, Master Salt, ID Context) of CTX_OLD. This can happen, for instance, after a device reboots.<a href="#section-2.4.3-2" class="pilcrow">¶</a></p>
<p id="section-2.4.3-3">Furthermore, when participating in a stand-alone OSCORE ID update procedure, a peer performs the following additional steps.<a href="#section-2.4.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.4.3-4.1">
              <p id="section-2.4.3-4.1.1">When a peer sends an ID update message, the value of the Recipient-ID Option that the peer specifies as its new intended OSCORE Recipient ID <span class="bcp14">MUST</span> fulfill both the following conditions: it is currently available as Recipient ID to use for the peer (see <span><a href="https://rfc-editor.org/rfc/rfc8613#section-3.3" class="relref">Section 3.3</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>); and the peer has never used it as Recipient ID with the current triplet (Master Secret, Master Salt, ID Context).<a href="#section-2.4.3-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.4.3-4.2">
              <p id="section-2.4.3-4.2.1">When receiving an ID update message, the peer <span class="bcp14">MUST</span> abort the procedure if it has already used the identifier specified in the Recipient-ID Option as its own Sender ID with the current triplet (Master Secret, Master Salt, ID Context).<a href="#section-2.4.3-4.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-2.4.3-5">In order to fulfill the conditions above, a peer has to keep track of the OSCORE Sender/Recipient IDs that it has used with the current triplet (Master Secret, Master Salt, ID Context) since the latest update of the OSCORE Master Secret (e.g., performed by running KUDOS).<a href="#section-2.4.3-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="preserving-observations-across-id-updates">
<section id="section-2.5">
        <h3 id="name-preserving-observations-acr">
<a href="#section-2.5" class="section-number selfRef">2.5. </a><a href="#name-preserving-observations-acr" class="section-name selfRef">Preserving Observations Across ID Updates</a>
        </h3>
<p id="section-2.5-1">When having run the OSCORE ID update procedure stand-alone and starting to use CTX_B, or having run the OSCORE ID update procedure integrated in an execution of KUDOS, the following holds if Observe <span>[<a href="#RFC7641" class="cite xref">RFC7641</a>]</span> is supported, in order to preserve ongoing observations beyond a change of OSCORE identifiers.<a href="#section-2.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.5-2.1">
            <p id="section-2.5-2.1.1">If a peer intends to keep active beyond an update of its Sender ID the observations where it is acting as CoAP client, then the peer:<a href="#section-2.5-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.5-2.1.2.1">
                <p id="section-2.5-2.1.2.1.1"><span class="bcp14">MUST</span> store the value of the 'kid' parameter from the original Observe requests, and retain it for the whole duration of the observations, throughout which the client <span class="bcp14">MUST NOT</span> update the stored value associated with the corresponding Observe registration request; and<a href="#section-2.5-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.5-2.1.2.2">
                <p id="section-2.5-2.1.2.2.1"><span class="bcp14">MUST</span> use the stored value of the 'kid' parameter from the original Observe registration request as value for the 'request_kid' parameter in the external_aad structure (see <span><a href="https://rfc-editor.org/rfc/rfc8613#section-5.4" class="relref">Section 5.4</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>), when verifying notifications for that observation as per <span><a href="https://rfc-editor.org/rfc/rfc8613#section-8.4.2" class="relref">Section 8.4.2</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>.<a href="#section-2.5-2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-2.5-2.2">
            <p id="section-2.5-2.2.1">If a peer is acting as CoAP server in an ongoing observation, then the peer:<a href="#section-2.5-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.5-2.2.2.1">
                <p id="section-2.5-2.2.2.1.1"><span class="bcp14">MUST</span> store the value of the 'kid' parameter from the original Observe registration request, and retain it for the whole duration of the observation, throughout which the peer <span class="bcp14">MUST NOT</span> update the stored value associated with the corresponding Observe registration request; and<a href="#section-2.5-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.5-2.2.2.2">
                <p id="section-2.5-2.2.2.2.1"><span class="bcp14">MUST</span> use the stored value of the 'kid' parameter from the original Observe registration request as value for the 'request_kid' parameter in the external_aad structure (see <span><a href="https://rfc-editor.org/rfc/rfc8613#section-5.4" class="relref">Section 5.4</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>), when protecting notifications for that observation as per <span><a href="https://rfc-editor.org/rfc/rfc8613#section-8.3.1" class="relref">Section 8.3.1</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>.<a href="#section-2.5-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-3">
      <h2 id="name-security-considerations">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-3-1">The same security considerations as in <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span> and <span>[<a href="#I-D.ietf-core-oscore-key-update" class="cite xref">I-D.ietf-core-oscore-key-update</a>]</span> hold for this document.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">The OSCORE ID update procedure is a mechanism to mitigate the risk of tracking by on-path adversaries. By enabling endpoints to update their identifiers, either in response to specific events or on a regular basis, this approach helps prevent correlations that could otherwise be drawn between OSCORE messages on different networks.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">While the ID update procedure helps reduce linkability across networks, the change of IDs alone might not completely prevent adversaries from recognizing traffic patterns that reveal message ordering or frequency. That is, the procedure becomes more effective if combined with the protection and/or change of other information that can help identify endpoints across different networks.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">In that spirit, when a peer installs a new OSCORE Security Context as a result of the OSCORE ID update procedure, it re-initializes the Sender Sequence Number to 0. That prevents an adversary from obviously tracking the peer by leveraging the Partial IV of observed messages, since the Partial IV value does not predictably continue from the last known value that was used in the previous network. Building on that, the peer can in fact re-initialize the Sender Sequence Number to a value greater than 0, thus making tracking further difficult.<a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5">Likewise, other information such as addressing information, may still be used to track the peers. Thus, it is recommended to combine the usage of the OSCORE ID update procedure also with the following, upon network migration:<a href="#section-3-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-6.1">
          <p id="section-3-6.1.1">Changing the network address (e.g., intentionally, or due to mobility, or NAT rebinding).<a href="#section-3-6.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-6.2">
          <p id="section-3-6.2.1">Changing the link-layer address (e.g., MAC address randomization).<a href="#section-3-6.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-3-7">Furthermore, it is recommended that a peer does not start using its newly established OSCORE Sender ID until after network migration, in order to mitigate tracking attempts.<a href="#section-3-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-iana">
<section id="section-4">
      <h2 id="name-iana-considerations">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-4-1">This document has the following actions for IANA.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">Note to RFC Editor: Please replace all occurrences of "[RFC-XXXX]" with the RFC number of this specification and delete this paragraph.<a href="#section-4-2" class="pilcrow">¶</a></p>
<div id="iana-coap-options">
<section id="section-4.1">
        <h3 id="name-coap-option-numbers-registr">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-coap-option-numbers-registr" class="section-name selfRef">CoAP Option Numbers Registry</a>
        </h3>
<p id="section-4.1-1">IANA is asked to enter the following entries to the "CoAP Option Numbers" registry within the "Constrained RESTful Environments (CoRE) Parameters" registry group.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<span id="name-new-coap-option-numbers"></span><div id="tab-iana-recipient-id-option">
<table class="center" id="table-3">
          <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-new-coap-option-numbers" class="selfRef">New CoAP Option Numbers</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Number</th>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">TBD24</td>
              <td class="text-left" rowspan="1" colspan="1">Recipient-ID</td>
              <td class="text-left" rowspan="1" colspan="1">[RFC-XXXX]</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">TBD32</td>
              <td class="text-left" rowspan="1" colspan="1">Recipient-ID-Ack</td>
              <td class="text-left" rowspan="1" colspan="1">[RFC-XXXX]</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-4.1-3">Note to RFC Editor: Following the registration of the CoAP Option Number 24, please replace "TBD24" with "24" in the table above. Then, please delete this paragraph.
Note to RFC Editor: Following the registration of the CoAP Option Number 32, please replace "TBD32" with "32" in the table above. Then, please delete this paragraph.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-combined-references">
<section id="section-5">
      <h2 id="name-references">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-5.1">
        <h3 id="name-normative-references">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-core-oscore-key-update">[I-D.ietf-core-oscore-key-update]</dt>
        <dd>
<span class="refAuthor">Höglund, R.</span> and <span class="refAuthor">M. Tiloca</span>, <span class="refTitle">"Key Update for OSCORE (KUDOS)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-oscore-key-update-11</span>, <time datetime="2025-07-07" class="refDate">7 July 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-key-update-11">https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-key-update-11</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7252">[RFC7252]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Hartke, K.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"The Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7252</span>, <span class="seriesInfo">DOI 10.17487/RFC7252</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7252">https://www.rfc-editor.org/rfc/rfc7252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7641">[RFC7641]</dt>
        <dd>
<span class="refAuthor">Hartke, K.</span>, <span class="refTitle">"Observing Resources in the Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7641</span>, <span class="seriesInfo">DOI 10.17487/RFC7641</span>, <time datetime="2015-09" class="refDate">September 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7641">https://www.rfc-editor.org/rfc/rfc7641</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8613">[RFC8613]</dt>
        <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Mattsson, J.</span>, <span class="refAuthor">Palombini, F.</span>, and <span class="refAuthor">L. Seitz</span>, <span class="refTitle">"Object Security for Constrained RESTful Environments (OSCORE)"</span>, <span class="seriesInfo">RFC 8613</span>, <span class="seriesInfo">DOI 10.17487/RFC8613</span>, <time datetime="2019-07" class="refDate">July 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8613">https://www.rfc-editor.org/rfc/rfc8613</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8949">[RFC8949]</dt>
      <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">STD 94</span>, <span class="seriesInfo">RFC 8949</span>, <span class="seriesInfo">DOI 10.17487/RFC8949</span>, <time datetime="2020-12" class="refDate">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8949">https://www.rfc-editor.org/rfc/rfc8949</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-5.2">
        <h3 id="name-informative-references">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC9528">[RFC9528]</dt>
      <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Preuß Mattsson, J.</span>, and <span class="refAuthor">F. Palombini</span>, <span class="refTitle">"Ephemeral Diffie-Hellman Over COSE (EDHOC)"</span>, <span class="seriesInfo">RFC 9528</span>, <span class="seriesInfo">DOI 10.17487/RFC9528</span>, <time datetime="2024-03" class="refDate">March 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9528">https://www.rfc-editor.org/rfc/rfc9528</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="examples">
<section id="appendix-A">
      <h2 id="name-examples">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-examples" class="section-name selfRef">Examples</a>
      </h2>
<p id="appendix-A-1">This appendix provides examples where the OSCORE ID update procedure is used. In particular:<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-2.1">
          <p id="appendix-A-2.1.1"><a href="#example-server-initiated-id-update" class="auto internal xref">Appendix A.1</a> shows an example of the OSCORE ID update procedure initiated by the server sending a response message.<a href="#appendix-A-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-2.2">
          <p id="appendix-A-2.2.1"><a href="#example-client-initiated-id-update-failure" class="auto internal xref">Appendix A.2</a> shows an example of the OSCORE ID update procedure initiated by the client sending a request message where the procedure fails to complete.<a href="#appendix-A-2.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<div id="example-server-initiated-id-update">
<section id="appendix-A.1">
        <h3 id="name-oscore-id-update-procedure-i">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-oscore-id-update-procedure-i" class="section-name selfRef">OSCORE ID Update Procedure Initiated with a Response Message</a>
        </h3>
<p id="appendix-A.1-1"><a href="#fig-id-update-server-init" class="auto internal xref">Figure 2</a> shows an example of the OSCORE ID update procedure, run stand-alone and initiated by the server sending a response message. On each peer, SID and RID denote the OSCORE Sender ID and Recipient ID of that peer, respectively. The prerequisites and the actions taken by the peers involved are aligned with what is described in <a href="#example-client-initiated-id-update" class="auto internal xref">Section 2.4.1</a>, except that it is the server that takes the initiative to perform the OSCORE ID update procedure.<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<span id="name-example-of-the-oscore-id-upd"></span><div id="fig-id-update-server-init">
<figure id="figure-2">
          <div id="appendix-A.1-2.1">
            <div class="alignCenter art-svg artwork" id="appendix-A.1-2.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="1872" width="496" viewBox="0 0 496 1872" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 104,48 L 104,1856" fill="none" stroke="black"></path>
                <path d="M 392,48 L 392,1856" fill="none" stroke="black"></path>
                <path d="M 112,160 L 384,160" fill="none" stroke="black"></path>
                <path d="M 112,336 L 384,336" fill="none" stroke="black"></path>
                <path d="M 112,560 L 384,560" fill="none" stroke="black"></path>
                <path d="M 112,784 L 384,784" fill="none" stroke="black"></path>
                <path d="M 112,992 L 384,992" fill="none" stroke="black"></path>
                <path d="M 112,1184 L 384,1184" fill="none" stroke="black"></path>
                <path d="M 112,1440 L 384,1440" fill="none" stroke="black"></path>
                <path d="M 112,1696 L 384,1696" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="392,1440 380,1434.4 380,1445.6" fill="black" transform="rotate(0,384,1440)"></polygon>
                <polygon class="arrowhead" points="392,992 380,986.4 380,997.6" fill="black" transform="rotate(0,384,992)"></polygon>
                <polygon class="arrowhead" points="392,560 380,554.4 380,565.6" fill="black" transform="rotate(0,384,560)"></polygon>
                <polygon class="arrowhead" points="392,160 380,154.4 380,165.6" fill="black" transform="rotate(0,384,160)"></polygon>
                <polygon class="arrowhead" points="120,1696 108,1690.4 108,1701.6" fill="black" transform="rotate(180,112,1696)"></polygon>
                <polygon class="arrowhead" points="120,1184 108,1178.4 108,1189.6" fill="black" transform="rotate(180,112,1184)"></polygon>
                <polygon class="arrowhead" points="120,784 108,778.4 108,789.6" fill="black" transform="rotate(180,112,784)"></polygon>
                <polygon class="arrowhead" points="120,336 108,330.4 108,341.6" fill="black" transform="rotate(180,112,336)"></polygon>
                <g class="text">
                  <text x="108" y="36">Client</text>
                  <text x="388" y="36">Server</text>
                  <text x="24" y="68">CTX_A</text>
                  <text x="56" y="68">{</text>
                  <text x="424" y="68">CTX_A</text>
                  <text x="456" y="68">{</text>
                  <text x="24" y="84">SID</text>
                  <text x="48" y="84">=</text>
                  <text x="76" y="84">0x01</text>
                  <text x="424" y="84">SID</text>
                  <text x="448" y="84">=</text>
                  <text x="476" y="84">0x00</text>
                  <text x="24" y="100">RID</text>
                  <text x="48" y="100">=</text>
                  <text x="76" y="100">0x00</text>
                  <text x="424" y="100">RID</text>
                  <text x="448" y="100">=</text>
                  <text x="476" y="100">0x01</text>
                  <text x="8" y="116">}</text>
                  <text x="408" y="116">}</text>
                  <text x="232" y="148">Request</text>
                  <text x="276" y="148">#1</text>
                  <text x="424" y="164">/temp</text>
                  <text x="140" y="180">OSCORE</text>
                  <text x="176" y="180">{</text>
                  <text x="128" y="196">...</text>
                  <text x="132" y="212">kid:</text>
                  <text x="172" y="212">0x01</text>
                  <text x="120" y="228">}</text>
                  <text x="152" y="244">Encrypted</text>
                  <text x="224" y="244">Payload</text>
                  <text x="264" y="244">{</text>
                  <text x="128" y="260">...</text>
                  <text x="160" y="276">Application</text>
                  <text x="240" y="276">Payload</text>
                  <text x="120" y="292">}</text>
                  <text x="236" y="324">Response</text>
                  <text x="284" y="324">#1</text>
                  <text x="432" y="340">Protect</text>
                  <text x="140" y="356">OSCORE</text>
                  <text x="176" y="356">{</text>
                  <text x="420" y="356">with</text>
                  <text x="464" y="356">CTX_A</text>
                  <text x="136" y="372">...</text>
                  <text x="28" y="388">Verify</text>
                  <text x="120" y="388">}</text>
                  <text x="20" y="404">with</text>
                  <text x="64" y="404">CTX_A</text>
                  <text x="152" y="404">Encrypted</text>
                  <text x="224" y="404">Payload</text>
                  <text x="264" y="404">{</text>
                  <text x="136" y="420">...</text>
                  <text x="176" y="436">Recipient-ID:</text>
                  <text x="252" y="436">0x42</text>
                  <text x="136" y="452">...</text>
                  <text x="168" y="468">Application</text>
                  <text x="248" y="468">Payload</text>
                  <text x="120" y="484">}</text>
                  <text x="232" y="548">Request</text>
                  <text x="276" y="548">#2</text>
                  <text x="32" y="564">Protect</text>
                  <text x="424" y="564">/temp</text>
                  <text x="20" y="580">with</text>
                  <text x="64" y="580">CTX_A</text>
                  <text x="140" y="580">OSCORE</text>
                  <text x="176" y="580">{</text>
                  <text x="136" y="596">...</text>
                  <text x="140" y="612">kid:</text>
                  <text x="180" y="612">0x01</text>
                  <text x="428" y="612">Verify</text>
                  <text x="120" y="628">}</text>
                  <text x="420" y="628">with</text>
                  <text x="464" y="628">CTX_A</text>
                  <text x="152" y="644">Encrypted</text>
                  <text x="224" y="644">Payload</text>
                  <text x="264" y="644">{</text>
                  <text x="136" y="660">...</text>
                  <text x="176" y="676">Recipient-ID:</text>
                  <text x="252" y="676">0x78</text>
                  <text x="192" y="692">Recipient-ID-Ack:</text>
                  <text x="284" y="692">0x42</text>
                  <text x="136" y="708">...</text>
                  <text x="168" y="724">Application</text>
                  <text x="248" y="724">Payload</text>
                  <text x="120" y="740">}</text>
                  <text x="236" y="772">Response</text>
                  <text x="284" y="772">#2</text>
                  <text x="432" y="788">Protect</text>
                  <text x="140" y="804">OSCORE</text>
                  <text x="176" y="804">{</text>
                  <text x="420" y="804">with</text>
                  <text x="464" y="804">CTX_A</text>
                  <text x="136" y="820">...</text>
                  <text x="28" y="836">Verify</text>
                  <text x="120" y="836">}</text>
                  <text x="20" y="852">with</text>
                  <text x="64" y="852">CTX_A</text>
                  <text x="152" y="852">Encrypted</text>
                  <text x="224" y="852">Payload</text>
                  <text x="264" y="852">{</text>
                  <text x="136" y="868">...</text>
                  <text x="192" y="884">Recipient-ID-Ack:</text>
                  <text x="284" y="884">0x78</text>
                  <text x="136" y="900">...</text>
                  <text x="168" y="916">Application</text>
                  <text x="248" y="916">Payload</text>
                  <text x="120" y="932">}</text>
                  <text x="232" y="980">Request</text>
                  <text x="276" y="980">#3</text>
                  <text x="32" y="996">Protect</text>
                  <text x="424" y="996">/temp</text>
                  <text x="20" y="1012">with</text>
                  <text x="64" y="1012">CTX_A</text>
                  <text x="140" y="1012">OSCORE</text>
                  <text x="176" y="1012">{</text>
                  <text x="136" y="1028">...</text>
                  <text x="140" y="1044">kid:</text>
                  <text x="180" y="1044">0x01</text>
                  <text x="428" y="1044">Verify</text>
                  <text x="120" y="1060">}</text>
                  <text x="420" y="1060">with</text>
                  <text x="464" y="1060">CTX_A</text>
                  <text x="152" y="1076">Encrypted</text>
                  <text x="224" y="1076">Payload</text>
                  <text x="264" y="1076">{</text>
                  <text x="136" y="1092">...</text>
                  <text x="192" y="1108">Recipient-ID-Ack:</text>
                  <text x="284" y="1108">0x42</text>
                  <text x="168" y="1124">Application</text>
                  <text x="248" y="1124">Payload</text>
                  <text x="120" y="1140">}</text>
                  <text x="236" y="1172">Response</text>
                  <text x="284" y="1172">#3</text>
                  <text x="432" y="1188">Protect</text>
                  <text x="140" y="1204">OSCORE</text>
                  <text x="176" y="1204">{</text>
                  <text x="420" y="1204">with</text>
                  <text x="464" y="1204">CTX_A</text>
                  <text x="136" y="1220">...</text>
                  <text x="28" y="1236">Verify</text>
                  <text x="120" y="1236">}</text>
                  <text x="20" y="1252">with</text>
                  <text x="64" y="1252">CTX_A</text>
                  <text x="152" y="1252">Encrypted</text>
                  <text x="224" y="1252">Payload</text>
                  <text x="264" y="1252">{</text>
                  <text x="136" y="1268">...</text>
                  <text x="192" y="1284">Recipient-ID-Ack:</text>
                  <text x="284" y="1284">0x78</text>
                  <text x="136" y="1300">...</text>
                  <text x="168" y="1316">Application</text>
                  <text x="248" y="1316">Payload</text>
                  <text x="120" y="1332">}</text>
                  <text x="232" y="1428">Request</text>
                  <text x="276" y="1428">#4</text>
                  <text x="32" y="1444">Protect</text>
                  <text x="424" y="1444">/temp</text>
                  <text x="20" y="1460">with</text>
                  <text x="64" y="1460">CTX_A</text>
                  <text x="140" y="1460">OSCORE</text>
                  <text x="176" y="1460">{</text>
                  <text x="136" y="1476">...</text>
                  <text x="140" y="1492">kid:</text>
                  <text x="180" y="1492">0x01</text>
                  <text x="428" y="1492">Verify</text>
                  <text x="120" y="1508">}</text>
                  <text x="420" y="1508">with</text>
                  <text x="464" y="1508">CTX_A</text>
                  <text x="152" y="1524">Encrypted</text>
                  <text x="224" y="1524">Payload</text>
                  <text x="264" y="1524">{</text>
                  <text x="136" y="1540">...</text>
                  <text x="192" y="1556">Recipient-ID-Ack:</text>
                  <text x="284" y="1556">0x42</text>
                  <text x="168" y="1572">Application</text>
                  <text x="248" y="1572">Payload</text>
                  <text x="120" y="1588">}</text>
                  <text x="420" y="1620">Safe</text>
                  <text x="452" y="1620">to</text>
                  <text x="432" y="1636">discard</text>
                  <text x="424" y="1652">CTX_A</text>
                  <text x="236" y="1684">Response</text>
                  <text x="284" y="1684">#4</text>
                  <text x="432" y="1700">Protect</text>
                  <text x="140" y="1716">OSCORE</text>
                  <text x="176" y="1716">{</text>
                  <text x="420" y="1716">with</text>
                  <text x="464" y="1716">CTX_A</text>
                  <text x="136" y="1732">...</text>
                  <text x="28" y="1748">Verify</text>
                  <text x="120" y="1748">}</text>
                  <text x="20" y="1764">with</text>
                  <text x="64" y="1764">CTX_A</text>
                  <text x="152" y="1764">Encrypted</text>
                  <text x="224" y="1764">Payload</text>
                  <text x="264" y="1764">{</text>
                  <text x="136" y="1780">...</text>
                  <text x="20" y="1796">Safe</text>
                  <text x="52" y="1796">to</text>
                  <text x="192" y="1796">Recipient-ID-Ack:</text>
                  <text x="284" y="1796">0x78</text>
                  <text x="32" y="1812">discard</text>
                  <text x="136" y="1812">...</text>
                  <text x="24" y="1828">CTX_A</text>
                  <text x="168" y="1828">Application</text>
                  <text x="248" y="1828">Payload</text>
                  <text x="120" y="1844">}</text>
                </g>
              </svg><a href="#appendix-A.1-2.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-example-of-the-oscore-id-upd" class="selfRef">Example of the OSCORE ID update procedure initiated with a response message</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="example-client-initiated-id-update-failure">
<section id="appendix-A.2">
        <h3 id="name-failure-of-the-oscore-id-up">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-failure-of-the-oscore-id-up" class="section-name selfRef">Failure of the OSCORE ID Update Procedure Initiated with a Request Message</a>
        </h3>
<p id="appendix-A.2-1"><a href="#fig-id-update-client-init-failure" class="auto internal xref">Figure 3</a> shows an example of the OSCORE ID update procedure, run stand-alone and initiated by the client sending a request message where the procedure fails to complete due to the server not including the Recipient-ID-Ack option or the Recipient-ID in its response messages. On each peer, SID and RID denote the OSCORE Sender ID and Recipient ID of that peer, respectively. This example assumes that the value of the REPEAT_TIMER on the client is such that it expires between each request the client sends.<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
<p id="appendix-A.2-2">The client repeatedly tries sending requests to the client including the Recipient-ID option, but does not receive acknowledgments in the form of responses containing the Response-ID-Ack option from the server. Thus the client eventually reaches the expiration of its ENDING_TIMER, aborts the OSCORE ID update procedure, and proceeds to continue communication with normal OSCORE messages.<a href="#appendix-A.2-2" class="pilcrow">¶</a></p>
<span id="name-example-of-the-oscore-id-upda"></span><div id="fig-id-update-client-init-failure">
<figure id="figure-3">
          <div id="appendix-A.2-3.1">
            <div class="alignCenter art-svg artwork" id="appendix-A.2-3.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="1728" width="496" viewBox="0 0 496 1728" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 104,48 L 104,1712" fill="none" stroke="black"></path>
                <path d="M 392,48 L 392,1712" fill="none" stroke="black"></path>
                <path d="M 112,160 L 384,160" fill="none" stroke="black"></path>
                <path d="M 112,368 L 384,368" fill="none" stroke="black"></path>
                <path d="M 112,560 L 384,560" fill="none" stroke="black"></path>
                <path d="M 112,768 L 384,768" fill="none" stroke="black"></path>
                <path d="M 112,944 L 384,944" fill="none" stroke="black"></path>
                <path d="M 112,1152 L 384,1152" fill="none" stroke="black"></path>
                <path d="M 112,1376 L 384,1376" fill="none" stroke="black"></path>
                <path d="M 112,1584 L 384,1584" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="392,1376 380,1370.4 380,1381.6" fill="black" transform="rotate(0,384,1376)"></polygon>
                <polygon class="arrowhead" points="392,944 380,938.4 380,949.6" fill="black" transform="rotate(0,384,944)"></polygon>
                <polygon class="arrowhead" points="392,560 380,554.4 380,565.6" fill="black" transform="rotate(0,384,560)"></polygon>
                <polygon class="arrowhead" points="392,160 380,154.4 380,165.6" fill="black" transform="rotate(0,384,160)"></polygon>
                <polygon class="arrowhead" points="120,1584 108,1578.4 108,1589.6" fill="black" transform="rotate(180,112,1584)"></polygon>
                <polygon class="arrowhead" points="120,1152 108,1146.4 108,1157.6" fill="black" transform="rotate(180,112,1152)"></polygon>
                <polygon class="arrowhead" points="120,768 108,762.4 108,773.6" fill="black" transform="rotate(180,112,768)"></polygon>
                <polygon class="arrowhead" points="120,368 108,362.4 108,373.6" fill="black" transform="rotate(180,112,368)"></polygon>
                <g class="text">
                  <text x="108" y="36">Client</text>
                  <text x="388" y="36">Server</text>
                  <text x="24" y="68">CTX_A</text>
                  <text x="56" y="68">{</text>
                  <text x="424" y="68">CTX_A</text>
                  <text x="456" y="68">{</text>
                  <text x="24" y="84">SID</text>
                  <text x="48" y="84">=</text>
                  <text x="76" y="84">0x01</text>
                  <text x="424" y="84">SID</text>
                  <text x="448" y="84">=</text>
                  <text x="476" y="84">0x00</text>
                  <text x="24" y="100">RID</text>
                  <text x="48" y="100">=</text>
                  <text x="76" y="100">0x00</text>
                  <text x="424" y="100">RID</text>
                  <text x="448" y="100">=</text>
                  <text x="476" y="100">0x01</text>
                  <text x="8" y="116">}</text>
                  <text x="408" y="116">}</text>
                  <text x="232" y="148">Request</text>
                  <text x="276" y="148">#1</text>
                  <text x="32" y="164">Protect</text>
                  <text x="424" y="164">/temp</text>
                  <text x="20" y="180">with</text>
                  <text x="64" y="180">CTX_A</text>
                  <text x="140" y="180">OSCORE</text>
                  <text x="176" y="180">{</text>
                  <text x="136" y="196">...</text>
                  <text x="140" y="212">kid:</text>
                  <text x="180" y="212">0x01</text>
                  <text x="428" y="212">Verify</text>
                  <text x="120" y="228">}</text>
                  <text x="420" y="228">with</text>
                  <text x="464" y="228">CTX_A</text>
                  <text x="152" y="244">Encrypted</text>
                  <text x="224" y="244">Payload</text>
                  <text x="264" y="244">{</text>
                  <text x="136" y="260">...</text>
                  <text x="176" y="276">Recipient-ID:</text>
                  <text x="252" y="276">0x42</text>
                  <text x="136" y="292">...</text>
                  <text x="168" y="308">Application</text>
                  <text x="248" y="308">Payload</text>
                  <text x="120" y="324">}</text>
                  <text x="236" y="356">Response</text>
                  <text x="284" y="356">#1</text>
                  <text x="432" y="372">Protect</text>
                  <text x="140" y="388">OSCORE</text>
                  <text x="176" y="388">{</text>
                  <text x="420" y="388">with</text>
                  <text x="464" y="388">CTX_A</text>
                  <text x="136" y="404">...</text>
                  <text x="28" y="420">Verify</text>
                  <text x="120" y="420">}</text>
                  <text x="20" y="436">with</text>
                  <text x="64" y="436">CTX_A</text>
                  <text x="152" y="436">Encrypted</text>
                  <text x="224" y="436">Payload</text>
                  <text x="264" y="436">{</text>
                  <text x="136" y="452">...</text>
                  <text x="168" y="468">Application</text>
                  <text x="248" y="468">Payload</text>
                  <text x="120" y="484">}</text>
                  <text x="232" y="548">Request</text>
                  <text x="276" y="548">#2</text>
                  <text x="32" y="564">Protect</text>
                  <text x="424" y="564">/temp</text>
                  <text x="20" y="580">with</text>
                  <text x="64" y="580">CTX_A</text>
                  <text x="140" y="580">OSCORE</text>
                  <text x="176" y="580">{</text>
                  <text x="136" y="596">...</text>
                  <text x="140" y="612">kid:</text>
                  <text x="180" y="612">0x01</text>
                  <text x="428" y="612">Verify</text>
                  <text x="120" y="628">}</text>
                  <text x="420" y="628">with</text>
                  <text x="464" y="628">CTX_A</text>
                  <text x="152" y="644">Encrypted</text>
                  <text x="224" y="644">Payload</text>
                  <text x="264" y="644">{</text>
                  <text x="136" y="660">...</text>
                  <text x="176" y="676">Recipient-ID:</text>
                  <text x="252" y="676">0x42</text>
                  <text x="136" y="692">...</text>
                  <text x="168" y="708">Application</text>
                  <text x="248" y="708">Payload</text>
                  <text x="120" y="724">}</text>
                  <text x="236" y="756">Response</text>
                  <text x="284" y="756">#2</text>
                  <text x="432" y="772">Protect</text>
                  <text x="140" y="788">OSCORE</text>
                  <text x="176" y="788">{</text>
                  <text x="420" y="788">with</text>
                  <text x="464" y="788">CTX_A</text>
                  <text x="136" y="804">...</text>
                  <text x="28" y="820">Verify</text>
                  <text x="120" y="820">}</text>
                  <text x="20" y="836">with</text>
                  <text x="64" y="836">CTX_A</text>
                  <text x="152" y="836">Encrypted</text>
                  <text x="224" y="836">Payload</text>
                  <text x="264" y="836">{</text>
                  <text x="136" y="852">...</text>
                  <text x="168" y="868">Application</text>
                  <text x="248" y="868">Payload</text>
                  <text x="120" y="884">}</text>
                  <text x="232" y="932">Request</text>
                  <text x="276" y="932">#3</text>
                  <text x="32" y="948">Protect</text>
                  <text x="424" y="948">/temp</text>
                  <text x="20" y="964">with</text>
                  <text x="64" y="964">CTX_A</text>
                  <text x="140" y="964">OSCORE</text>
                  <text x="176" y="964">{</text>
                  <text x="136" y="980">...</text>
                  <text x="140" y="996">kid:</text>
                  <text x="180" y="996">0x01</text>
                  <text x="428" y="996">Verify</text>
                  <text x="120" y="1012">}</text>
                  <text x="420" y="1012">with</text>
                  <text x="464" y="1012">CTX_A</text>
                  <text x="152" y="1028">Encrypted</text>
                  <text x="224" y="1028">Payload</text>
                  <text x="264" y="1028">{</text>
                  <text x="136" y="1044">...</text>
                  <text x="176" y="1060">Recipient-ID:</text>
                  <text x="252" y="1060">0x42</text>
                  <text x="136" y="1076">...</text>
                  <text x="168" y="1092">Application</text>
                  <text x="248" y="1092">Payload</text>
                  <text x="120" y="1108">}</text>
                  <text x="236" y="1140">Response</text>
                  <text x="284" y="1140">#3</text>
                  <text x="432" y="1156">Protect</text>
                  <text x="140" y="1172">OSCORE</text>
                  <text x="176" y="1172">{</text>
                  <text x="420" y="1172">with</text>
                  <text x="464" y="1172">CTX_A</text>
                  <text x="136" y="1188">...</text>
                  <text x="28" y="1204">Verify</text>
                  <text x="120" y="1204">}</text>
                  <text x="20" y="1220">with</text>
                  <text x="64" y="1220">CTX_A</text>
                  <text x="152" y="1220">Encrypted</text>
                  <text x="224" y="1220">Payload</text>
                  <text x="264" y="1220">{</text>
                  <text x="136" y="1236">...</text>
                  <text x="168" y="1252">Application</text>
                  <text x="248" y="1252">Payload</text>
                  <text x="120" y="1268">}</text>
                  <text x="32" y="1300">ENDING_</text>
                  <text x="24" y="1316">TIMER</text>
                  <text x="32" y="1332">expired</text>
                  <text x="232" y="1364">Request</text>
                  <text x="276" y="1364">#4</text>
                  <text x="32" y="1380">Protect</text>
                  <text x="424" y="1380">/temp</text>
                  <text x="20" y="1396">with</text>
                  <text x="64" y="1396">CTX_A</text>
                  <text x="140" y="1396">OSCORE</text>
                  <text x="176" y="1396">{</text>
                  <text x="136" y="1412">...</text>
                  <text x="140" y="1428">kid:</text>
                  <text x="180" y="1428">0x01</text>
                  <text x="428" y="1428">Verify</text>
                  <text x="120" y="1444">}</text>
                  <text x="420" y="1444">with</text>
                  <text x="464" y="1444">CTX_A</text>
                  <text x="152" y="1460">Encrypted</text>
                  <text x="224" y="1460">Payload</text>
                  <text x="264" y="1460">{</text>
                  <text x="136" y="1476">...</text>
                  <text x="168" y="1492">Application</text>
                  <text x="248" y="1492">Payload</text>
                  <text x="120" y="1508">}</text>
                  <text x="236" y="1572">Response</text>
                  <text x="284" y="1572">#4</text>
                  <text x="432" y="1588">Protect</text>
                  <text x="140" y="1604">OSCORE</text>
                  <text x="176" y="1604">{</text>
                  <text x="420" y="1604">with</text>
                  <text x="464" y="1604">CTX_A</text>
                  <text x="136" y="1620">...</text>
                  <text x="28" y="1636">Verify</text>
                  <text x="120" y="1636">}</text>
                  <text x="20" y="1652">with</text>
                  <text x="64" y="1652">CTX_A</text>
                  <text x="152" y="1652">Encrypted</text>
                  <text x="224" y="1652">Payload</text>
                  <text x="264" y="1652">{</text>
                  <text x="136" y="1668">...</text>
                  <text x="168" y="1684">Application</text>
                  <text x="248" y="1684">Payload</text>
                  <text x="120" y="1700">}</text>
                </g>
              </svg><a href="#appendix-A.2-3.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-example-of-the-oscore-id-upda" class="selfRef">Example of the OSCORE ID update procedure failing when initiated with a request message</a>
          </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="sec-document-updates">
<section id="appendix-B">
      <h2 id="name-document-updates">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-document-updates" class="section-name selfRef">Document Updates</a>
      </h2>
<p id="appendix-B-1">This section is to be removed before publishing as an RFC.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<div id="sec-04-05">
<section id="appendix-B.1">
        <h3 id="name-version-04-to-05">
<a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-version-04-to-05" class="section-name selfRef">Version -04 to -05</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-B.1-1.1">
            <p id="appendix-B.1-1.1.1">Editorial updates.<a href="#appendix-B.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.1-1.2">
            <p id="appendix-B.1-1.2.1">Add additional message flow examples, including a failure case.<a href="#appendix-B.1-1.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-03-04">
<section id="appendix-B.2">
        <h3 id="name-version-03-to-04">
<a href="#appendix-B.2" class="section-number selfRef">B.2. </a><a href="#name-version-03-to-04" class="section-name selfRef">Version -03 to -04</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-B.2-1.1">
            <p id="appendix-B.2-1.1.1">Fixes in presenting the new approach.<a href="#appendix-B.2-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-1.2">
            <p id="appendix-B.2-1.2.1">Early recommendations for initial values of timers.<a href="#appendix-B.2-1.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-02-03">
<section id="appendix-B.3">
        <h3 id="name-version-02-to-03">
<a href="#appendix-B.3" class="section-number selfRef">B.3. </a><a href="#name-version-02-to-03" class="section-name selfRef">Version -02 to -03</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-B.3-1.1">
            <p id="appendix-B.3-1.1.1">Editorial improvements.<a href="#appendix-B.3-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.3-1.2">
            <p id="appendix-B.3-1.2.1">Improved security considerations.<a href="#appendix-B.3-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.3-1.3">
            <p id="appendix-B.3-1.3.1">Using the ID update procedure ahead of network migration and switching to new IDs after migration.<a href="#appendix-B.3-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.3-1.4">
            <p id="appendix-B.3-1.4.1">Update design more in line with KUDOS.<a href="#appendix-B.3-1.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-01-02">
<section id="appendix-B.4">
        <h3 id="name-version-01-to-02">
<a href="#appendix-B.4" class="section-number selfRef">B.4. </a><a href="#name-version-01-to-02" class="section-name selfRef">Version -01 to -02</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-B.4-1.1">
            <p id="appendix-B.4-1.1.1">Split long section into subsections.<a href="#appendix-B.4-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.4-1.2">
            <p id="appendix-B.4-1.2.1">Updated references.<a href="#appendix-B.4-1.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-00-01">
<section id="appendix-B.5">
        <h3 id="name-version-00-to-01">
<a href="#appendix-B.5" class="section-number selfRef">B.5. </a><a href="#name-version-00-to-01" class="section-name selfRef">Version -00 to -01</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-B.5-1.1">
            <p id="appendix-B.5-1.1.1">Revised and extended error handling.<a href="#appendix-B.5-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.5-1.2">
            <p id="appendix-B.5-1.2.1">Specify that the Recipient-ID option may need to be empty.<a href="#appendix-B.5-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.5-1.3">
            <p id="appendix-B.5-1.3.1">Failure cases when running the ID update procedure integrated with KUDOS.<a href="#appendix-B.5-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.5-1.4">
            <p id="appendix-B.5-1.4.1">Clarifications and editorial improvements.<a href="#appendix-B.5-1.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-00">
<section id="appendix-B.6">
        <h3 id="name-version-00">
<a href="#appendix-B.6" class="section-number selfRef">B.6. </a><a href="#name-version-00" class="section-name selfRef">Version -00</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-B.6-1.1">
            <p id="appendix-B.6-1.1.1">Split out material from Key Update for OSCORE draft into this new document.<a href="#appendix-B.6-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.6-1.2">
            <p id="appendix-B.6-1.2.1">Extended terminology.<a href="#appendix-B.6-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.6-1.3">
            <p id="appendix-B.6-1.3.1">Editorial improvements.<a href="#appendix-B.6-1.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="acknowledgment">
<section id="appendix-C">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-C-1">The authors sincerely thank <span class="contact-name">Christian Amsüss</span>, <span class="contact-name">Carsten Bormann</span>, <span class="contact-name">John Preuß Mattsson</span>, and <span class="contact-name">Göran Selander</span> for their feedback and comments.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<p id="appendix-C-2">The work on this document has been partly supported by VINNOVA and the Celtic-Next projects CRITISEC and CYPRESS; and by the H2020 projects SIFIS-Home (Grant agreement 952652) and ARCADIAN-IoT (Grant agreement 101020259).<a href="#appendix-C-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-D">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Rikard Höglund</span></div>
<div dir="auto" class="left"><span class="org">RISE AB</span></div>
<div dir="auto" class="left"><span class="street-address">Isafjordsgatan 22</span></div>
<div dir="auto" class="left">SE-<span class="postal-code">16440 Stockholm</span> <span class="locality">Kista</span>
</div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:rikard.hoglund@ri.se" class="email">rikard.hoglund@ri.se</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Marco Tiloca</span></div>
<div dir="auto" class="left"><span class="org">RISE AB</span></div>
<div dir="auto" class="left"><span class="street-address">Isafjordsgatan 22</span></div>
<div dir="auto" class="left">SE-<span class="postal-code">16440 Stockholm</span> <span class="locality">Kista</span>
</div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:marco.tiloca@ri.se" class="email">marco.tiloca@ri.se</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>

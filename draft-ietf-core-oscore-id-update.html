<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Identifier Update for OSCORE</title>
<meta content="Rikard HÃ¶glund" name="author">
<meta content="Marco Tiloca" name="author">
<meta content="
       Two peers that communicate with the CoAP protocol can use the Object Security for Constrained RESTful Environments (OSCORE) protocol to protect their message exchanges end-to-end. To this end, the two peers share an OSCORE Security Context and a number of related identifiers. In particular, each of the two peers stores a Sender ID that identifies its own Sender Context within the Security Context, and a Recipient ID that identifies the Recipient Context associated with the other peer within the same Security Context. These identifiers are sent in plaintext within OSCORE-protected messages. Hence, they can be used to correlate messages exchanged between peers and track those peers, with consequent privacy implications. This document defines an OSCORE ID update procedure that two peers can use to update their OSCORE identifiers. This procedure can be run stand-alone or seamlessly integrated in an execution of the Key Update for OSCORE (KUDOS) procedure. 
    " name="description">
<meta content="xml2rfc 3.29.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-ietf-core-oscore-id-update-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.29.0
    Python 3.12.11
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.6
    lxml 5.3.1
    platformdirs 4.3.8
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.4
    setuptools 80.9.0
    wcwidth 0.2.13
-->
<link href="draft-ietf-core-oscore-id-update.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "â";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Identifier Update for OSCORE</td>
<td class="right">June 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">HÃ¶glund &amp; Tiloca</td>
<td class="center">Expires 27 December 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">CoRE Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-core-oscore-id-update-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-06-25" class="published">25 June 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-12-27">27 December 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">R. HÃ¶glund</div>
<div class="org">RISE AB</div>
</div>
<div class="author">
      <div class="author-name">M. Tiloca</div>
<div class="org">RISE AB</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Identifier Update for OSCORE</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">Two peers that communicate with the CoAP protocol can use the Object Security for Constrained RESTful Environments (OSCORE) protocol to protect their message exchanges end-to-end. To this end, the two peers share an OSCORE Security Context and a number of related identifiers. In particular, each of the two peers stores a Sender ID that identifies its own Sender Context within the Security Context, and a Recipient ID that identifies the Recipient Context associated with the other peer within the same Security Context. These identifiers are sent in plaintext within OSCORE-protected messages. Hence, they can be used to correlate messages exchanged between peers and track those peers, with consequent privacy implications. This document defines an OSCORE ID update procedure that two peers can use to update their OSCORE identifiers. This procedure can be run stand-alone or seamlessly integrated in an execution of the Key Update for OSCORE (KUDOS) procedure.<a href="#section-abstract-1" class="pilcrow">Â¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">Â¶</a></p>
<p id="section-note.1-2">
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-ietf-core-oscore-id-update/">https://datatracker.ietf.org/doc/draft-ietf-core-oscore-id-update/</a></span>.<a href="#section-note.1-2" class="pilcrow">Â¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        Constrained RESTful Environments (core) Working Group mailing list (<span><a href="mailto:core@ietf.org">mailto:core@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/core/">https://mailarchive.ietf.org/arch/browse/core/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/core/">https://www.ietf.org/mailman/listinfo/core/</a></span>.<a href="#section-note.1-3" class="pilcrow">Â¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/core-wg/oscore-id-update">https://github.com/core-wg/oscore-id-update</a></span>.<a href="#section-note.1-4" class="pilcrow">Â¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">Â¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">Â¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">Â¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 27 December 2025.<a href="#section-boilerplate.1-4" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">Â¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">â²</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.Â Â <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.Â Â <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.Â Â <a href="#name-update-of-oscore-sender-rec" class="internal xref">Update of OSCORE Sender/Recipient IDs</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="auto internal xref">2.1</a>.Â Â <a href="#name-failure-of-the-id-update-pr" class="internal xref">Failure of the ID Update Procedure</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.Â Â <a href="#name-the-recipient-id-option" class="internal xref">The Recipient-ID Option</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.1">
                    <p id="section-toc.1-1.2.2.2.2.1.1"><a href="#section-2.2.1" class="auto internal xref">2.2.1</a>.Â Â <a href="#name-forward-message-flow" class="internal xref">Forward Message Flow</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.2">
                    <p id="section-toc.1-1.2.2.2.2.2.1"><a href="#section-2.2.2" class="auto internal xref">2.2.2</a>.Â Â <a href="#name-reverse-message-flow" class="internal xref">Reverse Message Flow</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.3">
                    <p id="section-toc.1-1.2.2.2.2.3.1"><a href="#section-2.2.3" class="auto internal xref">2.2.3</a>.Â Â <a href="#name-additional-actions-for-exec" class="internal xref">Additional Actions for Execution</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="auto internal xref">2.3</a>.Â Â <a href="#name-preserving-observations-acr" class="internal xref">Preserving Observations Across ID Updates</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.Â Â <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.Â Â <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.Â Â <a href="#name-coap-option-numbers-registr" class="internal xref">CoAP Option Numbers Registry</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.Â Â <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.Â Â <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.Â Â <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.Â Â <a href="#name-examples-of-oscore-id-updat" class="internal xref">Examples of OSCORE ID update procedure Integrated in KUDOS</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.Â Â <a href="#name-forward-message-flow-2" class="internal xref">Forward Message Flow</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.Â Â <a href="#name-reverse-message-flow-2" class="internal xref">Reverse Message Flow</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.Â Â <a href="#name-document-updates" class="internal xref">Document Updates</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#appendix-B.1" class="auto internal xref">B.1</a>.Â Â <a href="#name-version-02-to-03" class="internal xref">Version -02 to -03</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#appendix-B.2" class="auto internal xref">B.2</a>.Â Â <a href="#name-version-01-to-02" class="internal xref">Version -01 to -02</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#appendix-B.3" class="auto internal xref">B.3</a>.Â Â <a href="#name-version-00-to-01" class="internal xref">Version -00 to -01</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#appendix-B.4" class="auto internal xref">B.4</a>.Â Â <a href="#name-version-00" class="internal xref">Version -00</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">When using the CoAP protocol <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>, two peers can use the Object Security for Constrained RESTful Environments (OSCORE) protocol to protect their message exchanges end-to-end. To this end, the two peers share an OSCORE Security Context and a number of related identifiers.<a href="#section-1-1" class="pilcrow">Â¶</a></p>
<p id="section-1-2">As part of the shared Security Context, each peer stores one Sender Context identified by a Sender ID and used to protect its outgoing messages. Also, it stores a Recipient Context identified by a Recipient ID and used to unprotect the incoming messages from the other peer. That is, one's peer Sender ID (Recipient ID) is equal to the other peer's Recipient ID (Sender ID).<a href="#section-1-2" class="pilcrow">Â¶</a></p>
<p id="section-1-3">When receiving an OSCORE-protected message, the recipient peer uses the Recipient ID conveyed within the message or otherwise implied, in order to retrieve the correct Security Context and unprotect the message.<a href="#section-1-3" class="pilcrow">Â¶</a></p>
<p id="section-1-4">These identifiers are sent in plaintext within OSCORE-protected messages and are immutable throughout the lifetime of a Security Context, even in case the two peers migrate to a different network or simply change their addressing information. Therefore, the identifiers can be used to correlate messages that the two peers exchange at different points in time or through different paths, hence allowing to track them with the consequent privacy implications.<a href="#section-1-4" class="pilcrow">Â¶</a></p>
<p id="section-1-5">In order to address this issue, this document defines an OSCORE ID update procedure that two peers can use to update their OSCORE Sender and Recipient IDs. For instance, two peers may want to use this procedure before switching to a different network, in order to make it more difficult to understand that their communication is continuing in the new network.<a href="#section-1-5" class="pilcrow">Â¶</a></p>
<p id="section-1-6">The OSCORE ID update procedure can be run stand-alone or seamlessly integrated in an execution of the Key Update for OSCORE (KUDOS) procedure <span>[<a href="#I-D.ietf-core-oscore-key-update" class="cite xref">I-D.ietf-core-oscore-key-update</a>]</span>.<a href="#section-1-6" class="pilcrow">Â¶</a></p>
<div id="terminology">
<section id="section-1.1">
        <h3 id="name-terminology">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.1-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCPÂ 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">Â¶</a></p>
<p id="section-1.1-2">Readers are expected to be familiar with the terms and concepts related to CoAP <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>, Observe <span>[<a href="#RFC7641" class="cite xref">RFC7641</a>]</span>, CBOR <span>[<a href="#RFC8949" class="cite xref">RFC8949</a>]</span>, OSCORE <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>, and KUDOS <span>[<a href="#I-D.ietf-core-oscore-key-update" class="cite xref">I-D.ietf-core-oscore-key-update</a>]</span>.<a href="#section-1.1-2" class="pilcrow">Â¶</a></p>
<p id="section-1.1-3">This document additionally uses the following terminology.<a href="#section-1.1-3" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-4.1">
            <p id="section-1.1-4.1.1">Initiator: the peer starting the OSCORE ID update procedure, by sending the first message.<a href="#section-1.1-4.1.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-1.1-4.2">
            <p id="section-1.1-4.2.1">Responder: the peer that receives the first message in an execution of the OSCORE ID update procedure.<a href="#section-1.1-4.2.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-1.1-4.3">
            <p id="section-1.1-4.3.1">Forward message flow: the execution workflow where the initiator acts as CoAP client (see <a href="#example-client-initiated-id-update" class="auto internal xref">Section 2.2.1</a>).<a href="#section-1.1-4.3.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="section-1.1-4.4">
            <p id="section-1.1-4.4.1">Reverse message flow: the execution workflow where the initiator acts as CoAP server (see <a href="#example-server-initiated-id-update" class="auto internal xref">Section 2.2.2</a>).<a href="#section-1.1-4.4.1" class="pilcrow">Â¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="update-oscore-ids">
<section id="section-2">
      <h2 id="name-update-of-oscore-sender-rec">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-update-of-oscore-sender-rec" class="section-name selfRef">Update of OSCORE Sender/Recipient IDs</a>
      </h2>
<p id="section-2-1">This section defines the procedure that two peers can perform, in order to update the OSCORE Sender/Recipient IDs that they use in their shared OSCORE Security Context.<a href="#section-2-1" class="pilcrow">Â¶</a></p>
<p id="section-2-2">When performing an update of OSCORE Sender/Recipient IDs, a peer provides its new intended OSCORE Recipient ID to the other peer, by means of the Recipient-ID Option defined in <a href="#sec-recipient-id-option" class="auto internal xref">Section 2.2</a>. Hereafter, this document refers to a message including the Recipient-ID Option as an "ID update (request/response) message".<a href="#section-2-2" class="pilcrow">Â¶</a></p>
<p id="section-2-3">This procedure can be initiated by either peer, i.e., the CoAP client or the CoAP server may start it by sending the first OSCORE ID update message. The former case is denoted as the "forward message flow" and the latter as the "reverse message flow".<a href="#section-2-3" class="pilcrow">Â¶</a></p>
<p id="section-2-4">Furthermore, this procedure can be executed stand-alone, or instead seamlessly integrated in an execution of the KUDOS procedure for updating OSCORE keying material used in its FS mode (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-key-update-10#section-4" class="relref">Section 4</a> of [<a href="#I-D.ietf-core-oscore-key-update" class="cite xref">I-D.ietf-core-oscore-key-update</a>]</span>) or no-FS mode (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-key-update-10#section-4.5" class="relref">Section 4.5</a> of [<a href="#I-D.ietf-core-oscore-key-update" class="cite xref">I-D.ietf-core-oscore-key-update</a>]</span>).<a href="#section-2-4" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-5.1">
          <p id="section-2-5.1.1">In the former stand-alone case, updating the OSCORE Sender/Recipient IDs effectively results in updating part of the current OSCORE Security Context.<a href="#section-2-5.1.1" class="pilcrow">Â¶</a></p>
<p id="section-2-5.1.2">
That is, both peers derive a new Sender Key, Recipient Key, and Common IV, as defined in <span><a href="https://rfc-editor.org/rfc/rfc8613#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>. Also, both peers re-initialize the Sender Sequence Number and the Replay Window accordingly, as defined in <span><a href="https://rfc-editor.org/rfc/rfc8613#section-3.2.2" class="relref">Section 3.2.2</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>. Since the same Master Secret is preserved, forward secrecy is not achieved.<a href="#section-2-5.1.2" class="pilcrow">Â¶</a></p>
<p id="section-2-5.1.3">
As defined in <a href="#id-update-additional-actions" class="auto internal xref">Section 2.2.3</a>, the two peers must take additional actions to ensure a safe execution of the OSCORE ID update procedure.<a href="#section-2-5.1.3" class="pilcrow">Â¶</a></p>
<p id="section-2-5.1.4">
A peer can safely discard the old OSCORE Security Context including the old OSCORE Sender/Recipient IDs after the following two events have occurred, in this order: first, the peer has sent to the other peer a message protected with the new OSCORE Security Context including the new OSCORE Sender/Recipient IDs; then, the peer has received from the other peer and successfully verified a message protected with that new OSCORE Security Context.<a href="#section-2-5.1.4" class="pilcrow">Â¶</a></p>
</li>
        <li class="normal" id="section-2-5.2">
          <p id="section-2-5.2.1">In the latter integrated case, the KUDOS initiator (responder) also acts as initiator (responder) for the OSCORE ID update procedure. That is, both KUDOS and the OSCORE ID update procedure <span class="bcp14">MUST</span> be run either in their forward message flow or in their reverse message flow.<a href="#section-2-5.2.1" class="pilcrow">Â¶</a></p>
<p id="section-2-5.2.2">
The new OSCORE Sender/Recipient IDs <span class="bcp14">MUST NOT</span> be used with the OSCORE Security Context CTX_OLD, and <span class="bcp14">MUST NOT</span> be used with the temporary OSCORE Security Context CTX_1 used to protect the first KUDOS message of a KUDOS execution.<a href="#section-2-5.2.2" class="pilcrow">Â¶</a></p>
<p id="section-2-5.2.3">
The first use of the new OSCORE Sender/Recipient IDs with the new OSCORE Security Context CTX_NEW occurs: for the KUDOS initiator, after having received from the KUDOS responder and successfully verified the second KUDOS message of the KUDOS execution in question; for the KUDOS responder, after having sent to the KUDOS initiator the second KUDOS message of the KUDOS execution in question.<a href="#section-2-5.2.3" class="pilcrow">Â¶</a></p>
</li>
      </ul>
<p id="section-2-6">A peer terminates an ongoing OSCORE ID update procedure with another peer as successful, in any of the following two cases.<a href="#section-2-6" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-7.1">
          <p id="section-2-7.1.1">The peer is acting as initiator, and it has received and successfully verified the second ID update message from the other peer.<a href="#section-2-7.1.1" class="pilcrow">Â¶</a></p>
</li>
        <li class="normal" id="section-2-7.2">
          <p id="section-2-7.2.1">The peer is acting as responder, and it has sent the second ID update message to the other peer.<a href="#section-2-7.2.1" class="pilcrow">Â¶</a></p>
</li>
      </ul>
<p id="section-2-8">A peer <span class="bcp14">MUST NOT</span> initiate an OSCORE ID update procedure with another peer, if it has another such procedure ongoing with that other peer.<a href="#section-2-8" class="pilcrow">Â¶</a></p>
<p id="section-2-9">Upon receiving a valid, first ID update message, a responder <span class="bcp14">MUST</span> send the second ID update message, except in the case any of the conditions for failing or aborting the procedure apply (see <a href="#update-failure" class="auto internal xref">Section 2.1</a>}).<a href="#section-2-9" class="pilcrow">Â¶</a></p>
<div id="update-failure">
<section id="section-2.1">
        <h3 id="name-failure-of-the-id-update-pr">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-failure-of-the-id-update-pr" class="section-name selfRef">Failure of the ID Update Procedure</a>
        </h3>
<p id="section-2.1-1">The following section describes cases where the OSCORE ID update procedure fails, or must to be aborted by one of the peers.<a href="#section-2.1-1" class="pilcrow">Â¶</a></p>
<p id="section-2.1-2">Upon receiving a valid first ID update message, a responder <span class="bcp14">MUST</span> abort the ID update procedure, in the following case:<a href="#section-2.1-2" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-3.1">
            <p id="section-2.1-3.1.1">The received ID update message is not a KUDOS message (i.e., the OSCORE ID update procedure is being performed stand-alone) and the responder has no eligible Recipient ID to offer to the initiator (see <a href="#id-update-additional-actions" class="auto internal xref">Section 2.2.3</a>).<a href="#section-2.1-3.1.1" class="pilcrow">Â¶</a></p>
</li>
        </ul>
<p id="section-2.1-4">Upon receiving a valid ID update message, a peer <span class="bcp14">MUST</span> abort the ID update procedure, in the following case:<a href="#section-2.1-4" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-5.1">
            <p id="section-2.1-5.1.1">The received ID update message contains a Recipient-ID option with a length that exceeds the maximum length of OSCORE Sender/Recipient IDs for the AEAD algorithm in use for the OSCORE Security Context shared between the peers. This is the case when the length of the Recipient-ID option exceeds the length of the AEAD nonce minus 6 (see <span><a href="https://rfc-editor.org/rfc/rfc8613#section-3.3" class="relref">Section 3.3</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>).<a href="#section-2.1-5.1.1" class="pilcrow">Â¶</a></p>
</li>
        </ul>
<p id="section-2.1-6">If, after receiving an ID update message as CoAP request, a peer aborts the ID update procedure, the peer <span class="bcp14">MUST</span> also reply to the received ID update request message with a protected 5.03 (Service Unavailable) error response. The error response <span class="bcp14">MUST NOT</span> include the Recipient-ID Option, and its diagnostic payload <span class="bcp14">MAY</span> provide additional information. When receiving the error response, the initiator terminates the OSCORE IDs procedure as failed.<a href="#section-2.1-6" class="pilcrow">Â¶</a></p>
<p id="section-2.1-7">An initiator terminates an ongoing OSCORE ID update procedure with another peer as failed, in case, after having sent the first ID update message for the procedure in question, a pre-defined amount of time has elapsed without receiving and successfully verifying the second ID update message from the other peer. It is <span class="bcp14">RECOMMENDED</span> that such an amount of time is equal to MAX_TRANSMIT_WAIT (see <span><a href="https://rfc-editor.org/rfc/rfc7252#section-4.8.2" class="relref">Section 4.8.2</a> of [<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>).<a href="#section-2.1-7" class="pilcrow">Â¶</a></p>
<p id="section-2.1-8">When the OSCORE ID update procedure is integrated into the execution of the KUDOS procedure, it is possible that the KUDOS procedure succeeds while the OSCORE ID update procedure fails. In such case, the peers continue their communications using the newly derived OSCORE Security Context CTX_NEW obtained from the KUDOS procedure, and still use the old Sender and Recipient IDs. That is, any Recipient IDs conveyed in the exchanged Recipient-ID Options is not considered.<a href="#section-2.1-8" class="pilcrow">Â¶</a></p>
<p id="section-2.1-9">Conversely, the OSCORE ID update procedure may succeed while the KUDOS procedure fails. As long as the peers have exchanged a pair of OSCORE-protected request and response that conveyed their desired new Recipient IDs in the Recipient-ID Option, the peers start using those IDs in their communications.<a href="#section-2.1-9" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="sec-recipient-id-option">
<section id="section-2.2">
        <h3 id="name-the-recipient-id-option">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-the-recipient-id-option" class="section-name selfRef">The Recipient-ID Option</a>
        </h3>
<p id="section-2.2-1">The Recipient ID-Option defined in this section has the properties summarized in <a href="#_table-recipient-id-option" class="auto internal xref">Table 1</a>, which extends Table 4 of <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>. That is, the option is elective, safe to forward, part of the cache key, and not repeatable.<a href="#section-2.2-1" class="pilcrow">Â¶</a></p>
<span id="name-the-recipient-id-option-ccr"></span><div id="_table-recipient-id-option">
<table class="center" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-the-recipient-id-option-ccr" class="selfRef">TheÂ Recipient-IDÂ Option. Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â  C=Critical, U=Unsafe, N=NoCacheKey, R=Repeatable</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">No.</th>
              <th class="text-left" rowspan="1" colspan="1">C</th>
              <th class="text-left" rowspan="1" colspan="1">U</th>
              <th class="text-left" rowspan="1" colspan="1">N</th>
              <th class="text-left" rowspan="1" colspan="1">R</th>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Format</th>
              <th class="text-left" rowspan="1" colspan="1">Length</th>
              <th class="text-left" rowspan="1" colspan="1">Default</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">TBD24</td>
              <td class="text-left" rowspan="1" colspan="1">Â </td>
              <td class="text-left" rowspan="1" colspan="1">Â </td>
              <td class="text-left" rowspan="1" colspan="1">Â </td>
              <td class="text-left" rowspan="1" colspan="1">Â </td>
              <td class="text-left" rowspan="1" colspan="1">Recipient-ID</td>
              <td class="text-left" rowspan="1" colspan="1">opaque</td>
              <td class="text-left" rowspan="1" colspan="1">any</td>
              <td class="text-left" rowspan="1" colspan="1">(none)</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-2.2-3">Note to RFC Editor: Following the registration of the CoAP Option Number 24, please replace "TBD24" with "24" in the figure above. Then, please delete this paragraph.<a href="#section-2.2-3" class="pilcrow">Â¶</a></p>
<p id="section-2.2-4">The option value can have an arbitrary length, including zero length to indicate intent to use the empty string as Recipient ID.<a href="#section-2.2-4" class="pilcrow">Â¶</a></p>
<p id="section-2.2-5">This document particularly defines how this option is used in messages protected with OSCORE. That is, when the option is included in an outgoing message, the option value specifies the new OSCORE Recipient ID that the sender endpoint intends to use with the other endpoint sharing the OSCORE Security Context.<a href="#section-2.2-5" class="pilcrow">Â¶</a></p>
<p id="section-2.2-6">Therefore, the maximum length of the option value is equal to the maximum length of OSCORE Sender/Recipient IDs. As defined in <span><a href="https://rfc-editor.org/rfc/rfc8613#section-3.3" class="relref">Section 3.3</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>, this is determined by the size of the AEAD nonce of the used AEAD Algorithm in the OSCORE Security Context.<a href="#section-2.2-6" class="pilcrow">Â¶</a></p>
<p id="section-2.2-7">If the length of the Recipient ID included in the Recipient-ID option is zero, the option value <span class="bcp14">SHALL</span> be empty (Option Length = 0).<a href="#section-2.2-7" class="pilcrow">Â¶</a></p>
<p id="section-2.2-8">The Recipient-ID Option is of class E in terms of OSCORE processing (see <span><a href="https://rfc-editor.org/rfc/rfc8613#section-4.1" class="relref">Section 4.1</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>).<a href="#section-2.2-8" class="pilcrow">Â¶</a></p>
<div id="example-client-initiated-id-update">
<section id="section-2.2.1">
          <h4 id="name-forward-message-flow">
<a href="#section-2.2.1" class="section-number selfRef">2.2.1. </a><a href="#name-forward-message-flow" class="section-name selfRef">Forward Message Flow</a>
          </h4>
<p id="section-2.2.1-1"><a href="#fig-id-update-client-init" class="auto internal xref">Figure 1</a> shows an example of the OSCORE ID update procedure, run stand-alone and in the forward message flow, with the client acting as initiator. On each peer, SID and RID denote the OSCORE Sender ID and Recipient ID of that peer, respectively.<a href="#section-2.2.1-1" class="pilcrow">Â¶</a></p>
<p id="section-2.2.1-2"><a href="#sec-id-update-in-kudos-forward" class="auto internal xref">Appendix A.1</a> provides a different example of the OSCORE ID update procedure, as run integrated in an execution of KUDOS and in the forward message flow (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-key-update-10#section-4.3.5" class="relref">Section 4.3.5</a> of [<a href="#I-D.ietf-core-oscore-key-update" class="cite xref">I-D.ietf-core-oscore-key-update</a>]</span>).<a href="#section-2.2.1-2" class="pilcrow">Â¶</a></p>
<span id="name-example-of-the-oscore-id-up"></span><div id="fig-id-update-client-init">
<figure id="figure-1">
            <div id="section-2.2.1-3.1">
              <div class="alignCenter art-svg artwork" id="section-2.2.1-3.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="1408" width="496" viewBox="0 0 496 1408" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 104,64 L 104,1392" fill="none" stroke="black"></path>
                  <path d="M 392,64 L 392,1392" fill="none" stroke="black"></path>
                  <path d="M 112,176 L 384,176" fill="none" stroke="black"></path>
                  <path d="M 112,384 L 384,384" fill="none" stroke="black"></path>
                  <path d="M 112,656 L 384,656" fill="none" stroke="black"></path>
                  <path d="M 112,832 L 384,832" fill="none" stroke="black"></path>
                  <path d="M 112,1040 L 384,1040" fill="none" stroke="black"></path>
                  <path d="M 112,1264 L 384,1264" fill="none" stroke="black"></path>
                  <polygon class="arrowhead" points="392,1040 380,1034.4 380,1045.6" fill="black" transform="rotate(0,384,1040)"></polygon>
                  <polygon class="arrowhead" points="392,656 380,650.4 380,661.6" fill="black" transform="rotate(0,384,656)"></polygon>
                  <polygon class="arrowhead" points="392,176 380,170.4 380,181.6" fill="black" transform="rotate(0,384,176)"></polygon>
                  <polygon class="arrowhead" points="120,1264 108,1258.4 108,1269.6" fill="black" transform="rotate(180,112,1264)"></polygon>
                  <polygon class="arrowhead" points="120,832 108,826.4 108,837.6" fill="black" transform="rotate(180,112,832)"></polygon>
                  <polygon class="arrowhead" points="120,384 108,378.4 108,389.6" fill="black" transform="rotate(180,112,384)"></polygon>
                  <g class="text">
                    <text x="108" y="36">Client</text>
                    <text x="388" y="36">Server</text>
                    <text x="104" y="52">(initiator)</text>
                    <text x="392" y="52">(responder)</text>
                    <text x="24" y="84">CTX_A</text>
                    <text x="56" y="84">{</text>
                    <text x="424" y="84">CTX_A</text>
                    <text x="456" y="84">{</text>
                    <text x="24" y="100">SID</text>
                    <text x="48" y="100">=</text>
                    <text x="76" y="100">0x01</text>
                    <text x="424" y="100">SID</text>
                    <text x="448" y="100">=</text>
                    <text x="476" y="100">0x00</text>
                    <text x="24" y="116">RID</text>
                    <text x="48" y="116">=</text>
                    <text x="76" y="116">0x00</text>
                    <text x="424" y="116">RID</text>
                    <text x="448" y="116">=</text>
                    <text x="476" y="116">0x01</text>
                    <text x="8" y="132">}</text>
                    <text x="408" y="132">}</text>
                    <text x="232" y="164">Request</text>
                    <text x="276" y="164">#1</text>
                    <text x="32" y="180">Protect</text>
                    <text x="424" y="180">/temp</text>
                    <text x="20" y="196">with</text>
                    <text x="64" y="196">CTX_A</text>
                    <text x="140" y="196">OSCORE</text>
                    <text x="176" y="196">{</text>
                    <text x="136" y="212">...</text>
                    <text x="140" y="228">kid:</text>
                    <text x="180" y="228">0x01</text>
                    <text x="428" y="228">Verify</text>
                    <text x="120" y="244">}</text>
                    <text x="420" y="244">with</text>
                    <text x="464" y="244">CTX_A</text>
                    <text x="152" y="260">Encrypted</text>
                    <text x="224" y="260">Payload</text>
                    <text x="264" y="260">{</text>
                    <text x="136" y="276">...</text>
                    <text x="176" y="292">Recipient-ID:</text>
                    <text x="252" y="292">0x42</text>
                    <text x="136" y="308">...</text>
                    <text x="168" y="324">Application</text>
                    <text x="248" y="324">Payload</text>
                    <text x="120" y="340">}</text>
                    <text x="236" y="372">Response</text>
                    <text x="284" y="372">#1</text>
                    <text x="432" y="388">Protect</text>
                    <text x="140" y="404">OSCORE</text>
                    <text x="176" y="404">{</text>
                    <text x="420" y="404">with</text>
                    <text x="464" y="404">CTX_A</text>
                    <text x="136" y="420">...</text>
                    <text x="28" y="436">Verify</text>
                    <text x="120" y="436">}</text>
                    <text x="20" y="452">with</text>
                    <text x="64" y="452">CTX_A</text>
                    <text x="152" y="452">Encrypted</text>
                    <text x="224" y="452">Payload</text>
                    <text x="264" y="452">{</text>
                    <text x="136" y="468">...</text>
                    <text x="176" y="484">Recipient-ID:</text>
                    <text x="252" y="484">0x78</text>
                    <text x="136" y="500">...</text>
                    <text x="168" y="516">Application</text>
                    <text x="248" y="516">Payload</text>
                    <text x="120" y="532">}</text>
                    <text x="24" y="564">CTX_B</text>
                    <text x="56" y="564">{</text>
                    <text x="424" y="564">CTX_B</text>
                    <text x="456" y="564">{</text>
                    <text x="24" y="580">SID</text>
                    <text x="48" y="580">=</text>
                    <text x="76" y="580">0x78</text>
                    <text x="424" y="580">SID</text>
                    <text x="448" y="580">=</text>
                    <text x="476" y="580">0x42</text>
                    <text x="24" y="596">RID</text>
                    <text x="48" y="596">=</text>
                    <text x="76" y="596">0x42</text>
                    <text x="424" y="596">RID</text>
                    <text x="448" y="596">=</text>
                    <text x="476" y="596">0x78</text>
                    <text x="8" y="612">}</text>
                    <text x="408" y="612">}</text>
                    <text x="232" y="644">Request</text>
                    <text x="276" y="644">#2</text>
                    <text x="32" y="660">Protect</text>
                    <text x="424" y="660">/temp</text>
                    <text x="20" y="676">with</text>
                    <text x="64" y="676">CTX_B</text>
                    <text x="140" y="676">OSCORE</text>
                    <text x="176" y="676">{</text>
                    <text x="136" y="692">...</text>
                    <text x="140" y="708">kid:</text>
                    <text x="180" y="708">0x78</text>
                    <text x="428" y="708">Verify</text>
                    <text x="120" y="724">}</text>
                    <text x="420" y="724">with</text>
                    <text x="464" y="724">CTX_B</text>
                    <text x="152" y="740">Encrypted</text>
                    <text x="224" y="740">Payload</text>
                    <text x="264" y="740">{</text>
                    <text x="136" y="756">...</text>
                    <text x="168" y="772">Application</text>
                    <text x="248" y="772">Payload</text>
                    <text x="120" y="788">}</text>
                    <text x="236" y="820">Response</text>
                    <text x="284" y="820">#2</text>
                    <text x="432" y="836">Protect</text>
                    <text x="140" y="852">OSCORE</text>
                    <text x="176" y="852">{</text>
                    <text x="420" y="852">with</text>
                    <text x="464" y="852">CTX_B</text>
                    <text x="136" y="868">...</text>
                    <text x="28" y="884">Verify</text>
                    <text x="120" y="884">}</text>
                    <text x="20" y="900">with</text>
                    <text x="64" y="900">CTX_B</text>
                    <text x="152" y="900">Encrypted</text>
                    <text x="224" y="900">Payload</text>
                    <text x="264" y="900">{</text>
                    <text x="136" y="916">...</text>
                    <text x="168" y="932">Application</text>
                    <text x="248" y="932">Payload</text>
                    <text x="120" y="948">}</text>
                    <text x="32" y="980">Discard</text>
                    <text x="24" y="996">CTX_A</text>
                    <text x="232" y="1028">Request</text>
                    <text x="276" y="1028">#3</text>
                    <text x="32" y="1044">Protect</text>
                    <text x="424" y="1044">/temp</text>
                    <text x="20" y="1060">with</text>
                    <text x="64" y="1060">CTX_B</text>
                    <text x="140" y="1060">OSCORE</text>
                    <text x="176" y="1060">{</text>
                    <text x="136" y="1076">...</text>
                    <text x="140" y="1092">kid:</text>
                    <text x="180" y="1092">0x78</text>
                    <text x="428" y="1092">Verify</text>
                    <text x="120" y="1108">}</text>
                    <text x="420" y="1108">with</text>
                    <text x="464" y="1108">CTX_B</text>
                    <text x="152" y="1124">Encrypted</text>
                    <text x="224" y="1124">Payload</text>
                    <text x="264" y="1124">{</text>
                    <text x="136" y="1140">...</text>
                    <text x="168" y="1156">Application</text>
                    <text x="248" y="1156">Payload</text>
                    <text x="120" y="1172">}</text>
                    <text x="432" y="1204">Discard</text>
                    <text x="424" y="1220">CTX_A</text>
                    <text x="236" y="1252">Response</text>
                    <text x="284" y="1252">#3</text>
                    <text x="432" y="1268">Protect</text>
                    <text x="140" y="1284">OSCORE</text>
                    <text x="176" y="1284">{</text>
                    <text x="420" y="1284">with</text>
                    <text x="464" y="1284">CTX_B</text>
                    <text x="136" y="1300">...</text>
                    <text x="28" y="1316">Verify</text>
                    <text x="120" y="1316">}</text>
                    <text x="20" y="1332">with</text>
                    <text x="64" y="1332">CTX_B</text>
                    <text x="152" y="1332">Encrypted</text>
                    <text x="224" y="1332">Payload</text>
                    <text x="264" y="1332">{</text>
                    <text x="136" y="1348">...</text>
                    <text x="168" y="1364">Application</text>
                    <text x="248" y="1364">Payload</text>
                    <text x="120" y="1380">}</text>
                  </g>
                </svg><a href="#section-2.2.1-3.1.1" class="pilcrow">Â¶</a>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-example-of-the-oscore-id-up" class="selfRef">Example of the OSCORE ID update procedure with Forward Message Flow</a>
            </figcaption></figure>
</div>
<p id="section-2.2.1-4">Before the OSCORE ID update procedure starts, the client (the server) shares with the server (the client) an OSCORE Security Context CTX_A with Sender ID 0x01 (0x00) and Recipient ID 0x00 (0x01).<a href="#section-2.2.1-4" class="pilcrow">Â¶</a></p>
<p id="section-2.2.1-5">When starting the OSCORE ID update procedure, the client determines its new intended OSCORE Recipient ID 0x42. Then, the client prepares a CoAP request targeting an application resource at the server. The request includes the Recipient-ID Option, with value the client's new Recipient ID 0x42.<a href="#section-2.2.1-5" class="pilcrow">Â¶</a></p>
<p id="section-2.2.1-6">The client protects the request with CTX_A, i.e., by using the keying material derived from the client's current Sender ID 0x01. The protected request specifies the client's current Sender ID 0x01 in the 'kid' field of the OSCORE Option. After that, the client sends the request to the server as Request #1.<a href="#section-2.2.1-6" class="pilcrow">Â¶</a></p>
<p id="section-2.2.1-7">Upon receiving, decrypting, and successfully verifying the OSCORE message Request #1, the server retrieves the value 0x42 from the Recipient-ID Option, and determines its new intended OSCORE Recipient ID 0x78. Then, the server prepares a CoAP response including the Recipient-ID Option, with value the server's new Recipient ID 0x78.<a href="#section-2.2.1-7" class="pilcrow">Â¶</a></p>
<p id="section-2.2.1-8">The server protects the response with CTX_A, i.e., by using the keying material derived from the server's current Sender ID 0x00. After that, the server sends the response to the client.<a href="#section-2.2.1-8" class="pilcrow">Â¶</a></p>
<p id="section-2.2.1-9">Then, the server considers 0x42 and 0x78 as its new Sender ID and Recipient ID to use with the client, respectively. As shown in the example, the server practically installs a new OSCORE Security Context CTX_B where: i) its Sender ID and Recipient ID are 0x42 and 0x78, respectively; ii) the Sender Sequence Number and the Replay Window are re-initialized (see <span><a href="https://rfc-editor.org/rfc/rfc8613#section-3.2.2" class="relref">Section 3.2.2</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>); iii) anything else is like in the OSCORE Security Context used to encrypt the OSCORE message Response #1.<a href="#section-2.2.1-9" class="pilcrow">Â¶</a></p>
<p id="section-2.2.1-10">Upon receiving, decrypting, and successfully verifying the OSCORE message Response #1, the client considers 0x78 and 0x42 as the new Sender ID and Recipient ID to use with the server, respectively. As shown in the example, the client practically installs a new OSCORE Security Context CTX_B where: i) its Sender ID and Recipient ID are 0x78 and 0x42, respectively; ii) the Sender Sequence Number and the Replay Window are re-initialized (see <span><a href="https://rfc-editor.org/rfc/rfc8613#section-3.2.2" class="relref">Section 3.2.2</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>); iii) anything else is like in the OSCORE Security Context used to decrypt the OSCORE message Response #1.<a href="#section-2.2.1-10" class="pilcrow">Â¶</a></p>
<p id="section-2.2.1-11">From then on, the client and the server can exchange messages protected with the OSCORE Security Context CTX_B, i.e., according to the new OSCORE Sender/Recipient IDs and using new keying material derived from those.<a href="#section-2.2.1-11" class="pilcrow">Â¶</a></p>
<p id="section-2.2.1-12">That is, the client sends the OSCORE message Request #2, which is protected with CTX_B and specifies the new client's Sender ID 0x78 in the 'kid' field of the OSCORE Option.<a href="#section-2.2.1-12" class="pilcrow">Â¶</a></p>
<p id="section-2.2.1-13">Upon receiving the OSCORE message Request #2, the server retrieves the OSCORE Security Context CTX_B, according to its new Recipient ID 0x78 specified in the 'kid' field of the OSCORE Option. Then, the server decrypts and verifies the response by using CTX_B. Finally, the server prepares a CoAP response Response #2, protects it with CTX_B, and sends it to the client.<a href="#section-2.2.1-13" class="pilcrow">Â¶</a></p>
<p id="section-2.2.1-14">Upon receiving the OSCORE message Response #2, the client decrypts and verifies it with the OSCORE Security Context CTX_B. In case of successful verification, the client confirms that the server is aligned with the new OSCORE Sender/Recipient IDs, and thus discards the OSCORE Security Context CTX_A.<a href="#section-2.2.1-14" class="pilcrow">Â¶</a></p>
<p id="section-2.2.1-15">After that, one further exchange occurs, where both the CoAP request and the CoAP response are protected with the OSCORE Security Context CTX_B. In particular, upon receiving, decrypting, and successfully verifying the OSCORE message Request #3, the server confirms that the client is aligned with the new OSCORE Sender/Recipient IDs, and thus discards the OSCORE Security Context CTX_A.<a href="#section-2.2.1-15" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="example-server-initiated-id-update">
<section id="section-2.2.2">
          <h4 id="name-reverse-message-flow">
<a href="#section-2.2.2" class="section-number selfRef">2.2.2. </a><a href="#name-reverse-message-flow" class="section-name selfRef">Reverse Message Flow</a>
          </h4>
<p id="section-2.2.2-1"><a href="#fig-id-update-server-init" class="auto internal xref">Figure 2</a> shows an example of the OSCORE ID update procedure, run stand-alone and in the reverse message flow, with the server acting as initiator. On each peer, SID and RID denote the OSCORE Sender ID and Recipient ID of that peer, respectively.<a href="#section-2.2.2-1" class="pilcrow">Â¶</a></p>
<p id="section-2.2.2-2"><a href="#sec-id-update-in-kudos-reverse" class="auto internal xref">Appendix A.2</a> provides a different example of the OSCORE ID update procedure, as run integrated in an execution of KUDOS and in the reverse message flow (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-key-update-10#section-4.3.6" class="relref">Section 4.3.6</a> of [<a href="#I-D.ietf-core-oscore-key-update" class="cite xref">I-D.ietf-core-oscore-key-update</a>]</span>).<a href="#section-2.2.2-2" class="pilcrow">Â¶</a></p>
<span id="name-example-of-the-oscore-id-upd"></span><div id="fig-id-update-server-init">
<figure id="figure-2">
            <div id="section-2.2.2-3.1">
              <div class="alignCenter art-svg artwork" id="section-2.2.2-3.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="1824" width="496" viewBox="0 0 496 1824" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 104,64 L 104,1808" fill="none" stroke="black"></path>
                  <path d="M 392,64 L 392,1808" fill="none" stroke="black"></path>
                  <path d="M 112,176 L 384,176" fill="none" stroke="black"></path>
                  <path d="M 112,352 L 384,352" fill="none" stroke="black"></path>
                  <path d="M 112,544 L 384,544" fill="none" stroke="black"></path>
                  <path d="M 112,832 L 384,832" fill="none" stroke="black"></path>
                  <path d="M 112,1072 L 384,1072" fill="none" stroke="black"></path>
                  <path d="M 112,1248 L 384,1248" fill="none" stroke="black"></path>
                  <path d="M 112,1456 L 384,1456" fill="none" stroke="black"></path>
                  <path d="M 112,1680 L 384,1680" fill="none" stroke="black"></path>
                  <polygon class="arrowhead" points="392,1456 380,1450.4 380,1461.6" fill="black" transform="rotate(0,384,1456)"></polygon>
                  <polygon class="arrowhead" points="392,1072 380,1066.4 380,1077.6" fill="black" transform="rotate(0,384,1072)"></polygon>
                  <polygon class="arrowhead" points="392,544 380,538.4 380,549.6" fill="black" transform="rotate(0,384,544)"></polygon>
                  <polygon class="arrowhead" points="392,176 380,170.4 380,181.6" fill="black" transform="rotate(0,384,176)"></polygon>
                  <polygon class="arrowhead" points="120,1680 108,1674.4 108,1685.6" fill="black" transform="rotate(180,112,1680)"></polygon>
                  <polygon class="arrowhead" points="120,1248 108,1242.4 108,1253.6" fill="black" transform="rotate(180,112,1248)"></polygon>
                  <polygon class="arrowhead" points="120,832 108,826.4 108,837.6" fill="black" transform="rotate(180,112,832)"></polygon>
                  <polygon class="arrowhead" points="120,352 108,346.4 108,357.6" fill="black" transform="rotate(180,112,352)"></polygon>
                  <g class="text">
                    <text x="108" y="36">Client</text>
                    <text x="388" y="36">Server</text>
                    <text x="104" y="52">(responder)</text>
                    <text x="392" y="52">(initiator)</text>
                    <text x="24" y="84">CTX_A</text>
                    <text x="56" y="84">{</text>
                    <text x="424" y="84">CTX_A</text>
                    <text x="456" y="84">{</text>
                    <text x="24" y="100">SID</text>
                    <text x="48" y="100">=</text>
                    <text x="76" y="100">0x01</text>
                    <text x="424" y="100">SID</text>
                    <text x="448" y="100">=</text>
                    <text x="476" y="100">0x00</text>
                    <text x="24" y="116">RID</text>
                    <text x="48" y="116">=</text>
                    <text x="76" y="116">0x00</text>
                    <text x="424" y="116">RID</text>
                    <text x="448" y="116">=</text>
                    <text x="476" y="116">0x01</text>
                    <text x="8" y="132">}</text>
                    <text x="408" y="132">}</text>
                    <text x="232" y="164">Request</text>
                    <text x="276" y="164">#1</text>
                    <text x="32" y="180">Protect</text>
                    <text x="424" y="180">/temp</text>
                    <text x="20" y="196">with</text>
                    <text x="64" y="196">CTX_A</text>
                    <text x="140" y="196">OSCORE</text>
                    <text x="176" y="196">{</text>
                    <text x="136" y="212">...</text>
                    <text x="140" y="228">kid:</text>
                    <text x="180" y="228">0x01</text>
                    <text x="428" y="228">Verify</text>
                    <text x="120" y="244">}</text>
                    <text x="420" y="244">with</text>
                    <text x="464" y="244">CTX_A</text>
                    <text x="152" y="260">Encrypted</text>
                    <text x="224" y="260">Payload</text>
                    <text x="264" y="260">{</text>
                    <text x="136" y="276">...</text>
                    <text x="168" y="292">Application</text>
                    <text x="248" y="292">Payload</text>
                    <text x="120" y="308">}</text>
                    <text x="236" y="340">Response</text>
                    <text x="284" y="340">#1</text>
                    <text x="432" y="356">Protect</text>
                    <text x="140" y="372">OSCORE</text>
                    <text x="176" y="372">{</text>
                    <text x="420" y="372">with</text>
                    <text x="464" y="372">CTX_A</text>
                    <text x="136" y="388">...</text>
                    <text x="28" y="404">Verify</text>
                    <text x="120" y="404">}</text>
                    <text x="20" y="420">with</text>
                    <text x="64" y="420">CTX_A</text>
                    <text x="152" y="420">Encrypted</text>
                    <text x="224" y="420">Payload</text>
                    <text x="264" y="420">{</text>
                    <text x="136" y="436">...</text>
                    <text x="176" y="452">Recipient-ID:</text>
                    <text x="252" y="452">0x78</text>
                    <text x="136" y="468">...</text>
                    <text x="168" y="484">Application</text>
                    <text x="248" y="484">Payload</text>
                    <text x="120" y="500">}</text>
                    <text x="232" y="532">Request</text>
                    <text x="276" y="532">#2</text>
                    <text x="32" y="548">Protect</text>
                    <text x="424" y="548">/temp</text>
                    <text x="20" y="564">with</text>
                    <text x="64" y="564">CTX_A</text>
                    <text x="140" y="564">OSCORE</text>
                    <text x="176" y="564">{</text>
                    <text x="136" y="580">...</text>
                    <text x="140" y="596">kid:</text>
                    <text x="180" y="596">0x01</text>
                    <text x="428" y="596">Verify</text>
                    <text x="120" y="612">}</text>
                    <text x="420" y="612">with</text>
                    <text x="464" y="612">CTX_A</text>
                    <text x="152" y="628">Encrypted</text>
                    <text x="224" y="628">Payload</text>
                    <text x="264" y="628">{</text>
                    <text x="136" y="644">...</text>
                    <text x="176" y="660">Recipient-ID:</text>
                    <text x="252" y="660">0x42</text>
                    <text x="136" y="676">...</text>
                    <text x="168" y="692">Application</text>
                    <text x="248" y="692">Payload</text>
                    <text x="120" y="708">}</text>
                    <text x="424" y="740">CTX_B</text>
                    <text x="456" y="740">{</text>
                    <text x="424" y="756">SID</text>
                    <text x="448" y="756">=</text>
                    <text x="476" y="756">0x42</text>
                    <text x="424" y="772">RID</text>
                    <text x="448" y="772">=</text>
                    <text x="476" y="772">0x78</text>
                    <text x="408" y="788">}</text>
                    <text x="236" y="820">Response</text>
                    <text x="284" y="820">#2</text>
                    <text x="432" y="836">Protect</text>
                    <text x="140" y="852">OSCORE</text>
                    <text x="176" y="852">{</text>
                    <text x="420" y="852">with</text>
                    <text x="464" y="852">CTX_A</text>
                    <text x="136" y="868">...</text>
                    <text x="28" y="884">Verify</text>
                    <text x="120" y="884">}</text>
                    <text x="20" y="900">with</text>
                    <text x="64" y="900">CTX_A</text>
                    <text x="152" y="900">Encrypted</text>
                    <text x="224" y="900">Payload</text>
                    <text x="264" y="900">{</text>
                    <text x="136" y="916">...</text>
                    <text x="168" y="932">Application</text>
                    <text x="248" y="932">Payload</text>
                    <text x="120" y="948">}</text>
                    <text x="24" y="980">CTX_B</text>
                    <text x="56" y="980">{</text>
                    <text x="24" y="996">SID</text>
                    <text x="48" y="996">=</text>
                    <text x="76" y="996">0x78</text>
                    <text x="24" y="1012">RID</text>
                    <text x="48" y="1012">=</text>
                    <text x="76" y="1012">0x42</text>
                    <text x="8" y="1028">}</text>
                    <text x="232" y="1060">Request</text>
                    <text x="276" y="1060">#3</text>
                    <text x="32" y="1076">Protect</text>
                    <text x="424" y="1076">/temp</text>
                    <text x="20" y="1092">with</text>
                    <text x="64" y="1092">CTX_B</text>
                    <text x="140" y="1092">OSCORE</text>
                    <text x="176" y="1092">{</text>
                    <text x="136" y="1108">...</text>
                    <text x="140" y="1124">kid:</text>
                    <text x="180" y="1124">0x78</text>
                    <text x="428" y="1124">Verify</text>
                    <text x="120" y="1140">}</text>
                    <text x="420" y="1140">with</text>
                    <text x="464" y="1140">CTX_B</text>
                    <text x="152" y="1156">Encrypted</text>
                    <text x="224" y="1156">Payload</text>
                    <text x="264" y="1156">{</text>
                    <text x="136" y="1172">...</text>
                    <text x="168" y="1188">Application</text>
                    <text x="248" y="1188">Payload</text>
                    <text x="120" y="1204">}</text>
                    <text x="236" y="1236">Response</text>
                    <text x="284" y="1236">#3</text>
                    <text x="432" y="1252">Protect</text>
                    <text x="140" y="1268">OSCORE</text>
                    <text x="176" y="1268">{</text>
                    <text x="420" y="1268">with</text>
                    <text x="464" y="1268">CTX_B</text>
                    <text x="136" y="1284">...</text>
                    <text x="28" y="1300">Verify</text>
                    <text x="120" y="1300">}</text>
                    <text x="20" y="1316">with</text>
                    <text x="64" y="1316">CTX_B</text>
                    <text x="152" y="1316">Encrypted</text>
                    <text x="224" y="1316">Payload</text>
                    <text x="264" y="1316">{</text>
                    <text x="136" y="1332">...</text>
                    <text x="168" y="1348">Application</text>
                    <text x="248" y="1348">Payload</text>
                    <text x="120" y="1364">}</text>
                    <text x="32" y="1396">Discard</text>
                    <text x="24" y="1412">CTX_A</text>
                    <text x="232" y="1444">Request</text>
                    <text x="276" y="1444">#4</text>
                    <text x="32" y="1460">Protect</text>
                    <text x="424" y="1460">/temp</text>
                    <text x="20" y="1476">with</text>
                    <text x="64" y="1476">CTX_B</text>
                    <text x="140" y="1476">OSCORE</text>
                    <text x="176" y="1476">{</text>
                    <text x="136" y="1492">...</text>
                    <text x="140" y="1508">kid:</text>
                    <text x="180" y="1508">0x78</text>
                    <text x="428" y="1508">Verify</text>
                    <text x="120" y="1524">}</text>
                    <text x="420" y="1524">with</text>
                    <text x="464" y="1524">CTX_B</text>
                    <text x="152" y="1540">Encrypted</text>
                    <text x="224" y="1540">Payload</text>
                    <text x="264" y="1540">{</text>
                    <text x="136" y="1556">...</text>
                    <text x="168" y="1572">Application</text>
                    <text x="248" y="1572">Payload</text>
                    <text x="120" y="1588">}</text>
                    <text x="432" y="1620">Discard</text>
                    <text x="424" y="1636">CTX_A</text>
                    <text x="236" y="1668">Response</text>
                    <text x="284" y="1668">#4</text>
                    <text x="432" y="1684">Protect</text>
                    <text x="140" y="1700">OSCORE</text>
                    <text x="176" y="1700">{</text>
                    <text x="420" y="1700">with</text>
                    <text x="464" y="1700">CTX_B</text>
                    <text x="136" y="1716">...</text>
                    <text x="28" y="1732">Verify</text>
                    <text x="120" y="1732">}</text>
                    <text x="20" y="1748">with</text>
                    <text x="64" y="1748">CTX_B</text>
                    <text x="152" y="1748">Encrypted</text>
                    <text x="224" y="1748">Payload</text>
                    <text x="264" y="1748">{</text>
                    <text x="136" y="1764">...</text>
                    <text x="168" y="1780">Application</text>
                    <text x="248" y="1780">Payload</text>
                    <text x="120" y="1796">}</text>
                  </g>
                </svg><a href="#section-2.2.2-3.1.1" class="pilcrow">Â¶</a>
</div>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-example-of-the-oscore-id-upd" class="selfRef">Example of the OSCORE ID update procedure with Reverse Message Flow</a>
            </figcaption></figure>
</div>
<p id="section-2.2.2-4">Before the OSCORE ID update procedure starts, the client (the server) shares with the server (the client) an OSCORE Security Context CTX_A with Sender ID 0x01 (0x00) and Recipient ID 0x00 (0x01).<a href="#section-2.2.2-4" class="pilcrow">Â¶</a></p>
<p id="section-2.2.2-5">At first, the client prepares a CoAP Request #1 targeting an application resource at the server. The client protects the request with CTX_A, i.e., by using the keying material derived from the client's current Sender ID 0x01. The protected request specifies the client's current Sender ID 0x01 in the 'kid' field of the OSCORE Option. After that, the client sends the request to the server as Request #1.<a href="#section-2.2.2-5" class="pilcrow">Â¶</a></p>
<p id="section-2.2.2-6">Upon receiving, decrypting, and successfully verifying the OSCORE message Request #1, the server decides to start an OSCORE ID update procedure. To this end, the server determines its new intended OSCORE Recipient ID 0x78. Then, the server prepares a CoAP response as a reply to the just received request and including the Recipient-ID Option, with value the server's new Recipient ID 0x78.<a href="#section-2.2.2-6" class="pilcrow">Â¶</a></p>
<p id="section-2.2.2-7">The server protects the response with CTX_A, i.e., by using the keying material derived from the server's current Sender ID 0x00. After that, the server sends the response to the client as Response #1.<a href="#section-2.2.2-7" class="pilcrow">Â¶</a></p>
<p id="section-2.2.2-8">Upon receiving, decrypting, and successfully verifying the OSCORE message Response #1, the client retrieves the value 0x78 from the Recipient-ID Option, and determines its new intended OSCORE Recipient ID 0x42. Then, the client prepares a CoAP request targeting an application resource at the server. The request includes the Recipient-ID Option, with value the client's new Recipient ID 0x42.<a href="#section-2.2.2-8" class="pilcrow">Â¶</a></p>
<p id="section-2.2.2-9">The client protects the request with CTX_A, i.e., by using the keying material derived from the client's current Sender ID 0x01. The protected request specifies the client's current Sender ID 0x01 in the 'kid' field of the OSCORE Option. After that, the client sends the request to the server as Request #2.<a href="#section-2.2.2-9" class="pilcrow">Â¶</a></p>
<p id="section-2.2.2-10">Upon receiving, decrypting, and successfully verifying the OSCORE message Request #2, the server retrieves the value 0x42 from the Recipient-ID Option. Then the server considers 0x42 and 0x78 as the new Sender ID and Recipient ID to use with the client, respectively. As shown in the example, the server practically installs a new OSCORE Security Context CTX_B where: i) its Sender ID and Recipient ID are 0x42 and 0x78, respectively; ii) the Sender Sequence Number and the Replay Window are re-initialized (see <span><a href="https://rfc-editor.org/rfc/rfc8613#section-3.2.2" class="relref">Section 3.2.2</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>); iii) anything else is like in the OSCORE Security Context used to encrypt the OSCORE message Request #2.<a href="#section-2.2.2-10" class="pilcrow">Â¶</a></p>
<p id="section-2.2.2-11">Then, the server prepares a CoAP response, as a reply to the just received request, and protects it with CTX_A, i.e., by using the keying material derived from the server's current Sender ID 0x00. After that, the server sends the response to the client as Response #2.<a href="#section-2.2.2-11" class="pilcrow">Â¶</a></p>
<p id="section-2.2.2-12">Upon receiving, decrypting, and successfully verifying the OSCORE message Response #2, the client considers 0x78 and 0x42 as the new Sender ID and Recipient ID to use with the server, respectively. As shown in the example, the client practically installs a new OSCORE Security Context CTX_B where: i) its Sender ID and Recipient ID are 0x78 and 0x42, respectively; ii) the Sender Sequence Number and the Replay Window are re-initialized (see <span><a href="https://rfc-editor.org/rfc/rfc8613#section-3.2.2" class="relref">Section 3.2.2</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>); iii) anything else is like in the OSCORE Security Context used to decrypt the OSCORE response.<a href="#section-2.2.2-12" class="pilcrow">Â¶</a></p>
<p id="section-2.2.2-13">From then on, the client and the server can exchange messages protected with the OSCORE Security Context CTX_B, i.e., according to the new OSCORE Sender/Recipient IDs and using new keying material derived from those.<a href="#section-2.2.2-13" class="pilcrow">Â¶</a></p>
<p id="section-2.2.2-14">That is, the client sends the OSCORE message Request #3, which is protected with CTX_B and specifies the new client's Sender ID 0x78 in the 'kid' field of the OSCORE Option.<a href="#section-2.2.2-14" class="pilcrow">Â¶</a></p>
<p id="section-2.2.2-15">Upon receiving the OSCORE message Request #3, the server retrieves the OSCORE Security Context CTX_B, according to its new Recipient ID 0x78 specified in the 'kid' field of the OSCORE Option. Then, the server decrypts and verifies the response by using CTX_B. Finally, the server prepares a CoAP response, protects it with CTX_B, and sends it to the client as Response #3.<a href="#section-2.2.2-15" class="pilcrow">Â¶</a></p>
<p id="section-2.2.2-16">Upon receiving the OSCORE message Response #3, the client decrypts and verifies it with the OSCORE Security Context CTX_B. In case of successful verification, the client confirms that the server is aligned with the new OSCORE Sender/Recipient IDs, and thus discards the OSCORE Security Context CTX_A.<a href="#section-2.2.2-16" class="pilcrow">Â¶</a></p>
<p id="section-2.2.2-17">After that, one further exchange occurs, where both the CoAP request and the CoAP response are protected with the OSCORE Security Context CTX_B. In particular, upon receiving, decrypting, and successfully verifying the OSCORE message Request #4, the server confirms that the client is aligned with the new OSCORE Sender/Recipient IDs, and thus discards the OSCORE Security Context CTX_A.<a href="#section-2.2.2-17" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="id-update-additional-actions">
<section id="section-2.2.3">
          <h4 id="name-additional-actions-for-exec">
<a href="#section-2.2.3" class="section-number selfRef">2.2.3. </a><a href="#name-additional-actions-for-exec" class="section-name selfRef">Additional Actions for Execution</a>
          </h4>
<p id="section-2.2.3-1">After having experienced a loss of state, a peer <span class="bcp14">MUST NOT</span> participate in a stand-alone OSCORE ID update procedure with another peer, until having performed a full-fledged establishment/renewal of an OSCORE Security Context with the other peer (e.g., by running KUDOS <span>[<a href="#I-D.ietf-core-oscore-key-update" class="cite xref">I-D.ietf-core-oscore-key-update</a>]</span> or the authenticated key establishment protocol EDHOC <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>).<a href="#section-2.2.3-1" class="pilcrow">Â¶</a></p>
<p id="section-2.2.3-2">More precisely, a peer has experienced a loss of state if it cannot access the latest snapshot of the latest OSCORE Security Context CTX_OLD or the whole set of OSCORE Sender/Recipient IDs that have been used with the triplet (Master Secret, Master Salt, ID Context) of CTX_OLD. This can happen, for instance, after a device reboots.<a href="#section-2.2.3-2" class="pilcrow">Â¶</a></p>
<p id="section-2.2.3-3">Furthermore, when participating in a stand-alone OSCORE ID update procedure, a peer performs the following additional steps.<a href="#section-2.2.3-3" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.3-4.1">
              <p id="section-2.2.3-4.1.1">When a peer sends an ID update message, the value of the Recipient-ID Option that the peer specifies as its new intended OSCORE Recipient ID <span class="bcp14">MUST</span> fulfill both the following conditions: it is currently available as Recipient ID to use for the peer (see <span><a href="https://rfc-editor.org/rfc/rfc8613#section-3.3" class="relref">Section 3.3</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>); and the peer has never used it as Recipient ID with the current triplet (Master Secret, Master Salt, ID Context).<a href="#section-2.2.3-4.1.1" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="section-2.2.3-4.2">
              <p id="section-2.2.3-4.2.1">When receiving an ID update message, the peer <span class="bcp14">MUST</span> abort the procedure if it has already used the identifier specified in the Recipient-ID Option as its own Sender ID with the current triplet (Master Secret, Master Salt, ID Context).<a href="#section-2.2.3-4.2.1" class="pilcrow">Â¶</a></p>
</li>
          </ul>
<p id="section-2.2.3-5">In order to fulfill the conditions above, a peer has to keep track of the OSCORE Sender/Recipient IDs that it has used with the current triplet (Master Secret, Master Salt, ID Context) since the latest update of the OSCORE Master Secret (e.g., performed by running KUDOS).<a href="#section-2.2.3-5" class="pilcrow">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="preserving-observations-across-id-updates">
<section id="section-2.3">
        <h3 id="name-preserving-observations-acr">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-preserving-observations-acr" class="section-name selfRef">Preserving Observations Across ID Updates</a>
        </h3>
<p id="section-2.3-1">When running the OSCORE ID update procedure stand-alone or integrated in an execution of KUDOS, the following holds if Observe <span>[<a href="#RFC7641" class="cite xref">RFC7641</a>]</span> is supported, in order to preserve ongoing observations beyond a change of OSCORE identifiers.<a href="#section-2.3-1" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3-2.1">
            <p id="section-2.3-2.1.1">If a peer intends to keep active beyond an update of its Sender ID the observations where it is acting as CoAP client, then the peer:<a href="#section-2.3-2.1.1" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3-2.1.2.1">
                <p id="section-2.3-2.1.2.1.1"><span class="bcp14">MUST</span> store the value of the 'kid' parameter from the original Observe requests, and retain it for the whole duration of the observations, throughout which the client <span class="bcp14">MUST NOT</span> update the stored value associated with the corresponding Observe registration request; and<a href="#section-2.3-2.1.2.1.1" class="pilcrow">Â¶</a></p>
</li>
              <li class="normal" id="section-2.3-2.1.2.2">
                <p id="section-2.3-2.1.2.2.1"><span class="bcp14">MUST</span> use the stored value of the 'kid' parameter from the original Observe registration request as value for the 'request_kid' parameter in the external_aad structure (see <span><a href="https://rfc-editor.org/rfc/rfc8613#section-5.4" class="relref">Section 5.4</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>), when verifying notifications for that observation as per <span><a href="https://rfc-editor.org/rfc/rfc8613#section-8.4.2" class="relref">Section 8.4.2</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>.<a href="#section-2.3-2.1.2.2.1" class="pilcrow">Â¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-2.3-2.2">
            <p id="section-2.3-2.2.1">If a peer is acting as CoAP server in an ongoing observation, then the peer:<a href="#section-2.3-2.2.1" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3-2.2.2.1">
                <p id="section-2.3-2.2.2.1.1"><span class="bcp14">MUST</span> store the value of the 'kid' parameter from the original Observe registration request, and retain it for the whole duration of the observation, throughout which the peer <span class="bcp14">MUST NOT</span> update the stored value associated with the corresponding Observe registration request; and<a href="#section-2.3-2.2.2.1.1" class="pilcrow">Â¶</a></p>
</li>
              <li class="normal" id="section-2.3-2.2.2.2">
                <p id="section-2.3-2.2.2.2.1"><span class="bcp14">MUST</span> use the stored value of the 'kid' parameter from the original Observe registration request as value for the 'request_kid' parameter in the external_aad structure (see <span><a href="https://rfc-editor.org/rfc/rfc8613#section-5.4" class="relref">Section 5.4</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>), when protecting notifications for that observation as per <span><a href="https://rfc-editor.org/rfc/rfc8613#section-8.3.1" class="relref">Section 8.3.1</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>.<a href="#section-2.3-2.2.2.2.1" class="pilcrow">Â¶</a></p>
</li>
            </ul>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-3">
      <h2 id="name-security-considerations">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-3-1">The OSCORE ID update procedure is a mechanism to mitigate the risk of tracking by on-path adversaries. By enabling endpoints to update their identifiers, either in response to specific events or on a regular basis, this approach prevents correlations that could otherwise be drawn between OSCORE messages on different network paths. While the ID update procedure is effective in reducing linkability across paths, it is best used in together with encryption of the OSCORE Partial IV.<a href="#section-3-1" class="pilcrow">Â¶</a></p>
<p id="section-3-2">The encryption of the Partial IV defends against correlation of messages based on sequence number patterns, which can still occur even when identifiers are updated. This combined approach significantly improves unlinkability of messages, making it more difficult for adversaries to infer relationships between them or to track communicating parties over time and across paths.<a href="#section-3-2" class="pilcrow">Â¶</a></p>
<p id="section-3-3">Usage of the OSCORE ID update procedure in isolation may not completely prevent adversaries from recognizing traffic patterns that reveal message ordering or frequency. In addition adversaries can infer identities of peers based on the sequence numbers (reset to zero or incrementing values), which may still allow for tracking peers across networks.<a href="#section-3-3" class="pilcrow">Â¶</a></p>
<p id="section-3-4">Note that while the OSCORE ID update procedure updates the OSCORE identifiers used, other information from the network communication may still be used to track the peers. Thus, it is recommended to combine usage of the OSCORE ID update procedure also with the following:<a href="#section-3-4" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-5.1">
          <p id="section-3-5.1.1">Changing the network address (e.g., intentionally, or due to mobility, or NAT rebinding).<a href="#section-3-5.1.1" class="pilcrow">Â¶</a></p>
</li>
        <li class="normal" id="section-3-5.2">
          <p id="section-3-5.2.1">Changing the link-layer address (e.g., MAC address randomization).<a href="#section-3-5.2.1" class="pilcrow">Â¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="sec-iana">
<section id="section-4">
      <h2 id="name-iana-considerations">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-4-1">This document has the following actions for IANA.<a href="#section-4-1" class="pilcrow">Â¶</a></p>
<p id="section-4-2">Note to RFC Editor: Please replace all occurrences of "[RFC-XXXX]" with the RFC number of this specification and delete this paragraph.<a href="#section-4-2" class="pilcrow">Â¶</a></p>
<div id="iana-coap-options">
<section id="section-4.1">
        <h3 id="name-coap-option-numbers-registr">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-coap-option-numbers-registr" class="section-name selfRef">CoAP Option Numbers Registry</a>
        </h3>
<p id="section-4.1-1">IANA is asked to enter the following option number to the "CoAP Option Numbers" registry within the "Constrained RESTful Environments (CoRE) Parameters" registry group.<a href="#section-4.1-1" class="pilcrow">Â¶</a></p>
<span id="name-new-coap-option-number"></span><div id="tab-iana-recipient-id-option">
<table class="center" id="table-2">
          <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-new-coap-option-number" class="selfRef">New CoAP Option Number</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Number</th>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">TBD24</td>
              <td class="text-left" rowspan="1" colspan="1">Recipient-ID</td>
              <td class="text-left" rowspan="1" colspan="1">[RFC-XXXX]</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-4.1-3">Note to RFC Editor: Following the registration of the CoAP Option Number 24, please replace "TBD24" with "24" in the table above. Then, please delete this paragraph.<a href="#section-4.1-3" class="pilcrow">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-combined-references">
<section id="section-5">
      <h2 id="name-references">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-5.1">
        <h3 id="name-normative-references">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-core-oscore-key-update">[I-D.ietf-core-oscore-key-update]</dt>
        <dd>
<span class="refAuthor">HÃ¶glund, R.</span> and <span class="refAuthor">M. Tiloca</span>, <span class="refTitle">"Key Update for OSCORE (KUDOS)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-oscore-key-update-10</span>, <time datetime="2025-03-03" class="refDate">3 March 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-key-update-10">https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-key-update-10</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7252">[RFC7252]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Hartke, K.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"The Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7252</span>, <span class="seriesInfo">DOI 10.17487/RFC7252</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7252">https://www.rfc-editor.org/rfc/rfc7252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7641">[RFC7641]</dt>
        <dd>
<span class="refAuthor">Hartke, K.</span>, <span class="refTitle">"Observing Resources in the Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7641</span>, <span class="seriesInfo">DOI 10.17487/RFC7641</span>, <time datetime="2015-09" class="refDate">September 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7641">https://www.rfc-editor.org/rfc/rfc7641</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8613">[RFC8613]</dt>
        <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Mattsson, J.</span>, <span class="refAuthor">Palombini, F.</span>, and <span class="refAuthor">L. Seitz</span>, <span class="refTitle">"Object Security for Constrained RESTful Environments (OSCORE)"</span>, <span class="seriesInfo">RFC 8613</span>, <span class="seriesInfo">DOI 10.17487/RFC8613</span>, <time datetime="2019-07" class="refDate">July 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8613">https://www.rfc-editor.org/rfc/rfc8613</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8949">[RFC8949]</dt>
      <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">STD 94</span>, <span class="seriesInfo">RFC 8949</span>, <span class="seriesInfo">DOI 10.17487/RFC8949</span>, <time datetime="2020-12" class="refDate">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8949">https://www.rfc-editor.org/rfc/rfc8949</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-5.2">
        <h3 id="name-informative-references">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC9528">[RFC9528]</dt>
      <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">PreuÃ Mattsson, J.</span>, and <span class="refAuthor">F. Palombini</span>, <span class="refTitle">"Ephemeral Diffie-Hellman Over COSE (EDHOC)"</span>, <span class="seriesInfo">RFC 9528</span>, <span class="seriesInfo">DOI 10.17487/RFC9528</span>, <time datetime="2024-03" class="refDate">March 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9528">https://www.rfc-editor.org/rfc/rfc9528</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="sec-id-update-in-kudos">
<section id="appendix-A">
      <h2 id="name-examples-of-oscore-id-updat">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-examples-of-oscore-id-updat" class="section-name selfRef">Examples of OSCORE ID update procedure Integrated in KUDOS</a>
      </h2>
<p id="appendix-A-1">The following section shows two examples where the OSCORE ID update procedure is performed together with the KUDOS procedure for updating OSCORE keying material.<a href="#appendix-A-1" class="pilcrow">Â¶</a></p>
<div id="sec-id-update-in-kudos-forward">
<section id="appendix-A.1">
        <h3 id="name-forward-message-flow-2">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-forward-message-flow-2" class="section-name selfRef">Forward Message Flow</a>
        </h3>
<p id="appendix-A.1-1"><a href="#fig-kudos-and-id-update-client-init" class="auto internal xref">Figure 3</a> provides an example of the OSCORE ID update procedure, as run integrated in an execution of KUDOS and in the forward message flow (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-key-update-10#section-4.3.5" class="relref">Section 4.3.5</a> of [<a href="#I-D.ietf-core-oscore-key-update" class="cite xref">I-D.ietf-core-oscore-key-update</a>]</span>). On each peer, SID and RID denote the OSCORE Sender ID and Recipient ID of that peer, respectively.<a href="#appendix-A.1-1" class="pilcrow">Â¶</a></p>
<span id="name-example-of-the-oscore-id-upda"></span><div id="fig-kudos-and-id-update-client-init">
<figure id="figure-3">
          <div id="appendix-A.1-2.1">
            <div class="alignCenter art-svg artwork" id="appendix-A.1-2.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="1312" width="576" viewBox="0 0 576 1312" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 200,64 L 200,880" fill="none" stroke="black"></path>
                <path d="M 200,960 L 200,1296" fill="none" stroke="black"></path>
                <path d="M 384,64 L 384,880" fill="none" stroke="black"></path>
                <path d="M 384,960 L 384,1296" fill="none" stroke="black"></path>
                <path d="M 208,288 L 376,288" fill="none" stroke="black"></path>
                <path d="M 208,576 L 376,576" fill="none" stroke="black"></path>
                <path d="M 208,992 L 376,992" fill="none" stroke="black"></path>
                <path d="M 208,1168 L 376,1168" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="384,992 372,986.4 372,997.6" fill="black" transform="rotate(0,376,992)"></polygon>
                <polygon class="arrowhead" points="384,288 372,282.4 372,293.6" fill="black" transform="rotate(0,376,288)"></polygon>
                <polygon class="arrowhead" points="216,1168 204,1162.4 204,1173.6" fill="black" transform="rotate(180,208,1168)"></polygon>
                <polygon class="arrowhead" points="216,576 204,570.4 204,581.6" fill="black" transform="rotate(180,208,576)"></polygon>
                <g class="text">
                  <text x="196" y="36">Client</text>
                  <text x="388" y="36">Server</text>
                  <text x="200" y="52">(initiator)</text>
                  <text x="384" y="52">(responder)</text>
                  <text x="32" y="84">CTX_OLD</text>
                  <text x="72" y="84">{</text>
                  <text x="424" y="84">CTX_OLD</text>
                  <text x="464" y="84">{</text>
                  <text x="24" y="100">SID</text>
                  <text x="48" y="100">=</text>
                  <text x="76" y="100">0x01</text>
                  <text x="416" y="100">SID</text>
                  <text x="440" y="100">=</text>
                  <text x="468" y="100">0x00</text>
                  <text x="24" y="116">RID</text>
                  <text x="48" y="116">=</text>
                  <text x="76" y="116">0x00</text>
                  <text x="416" y="116">RID</text>
                  <text x="440" y="116">=</text>
                  <text x="468" y="116">0x01</text>
                  <text x="8" y="132">}</text>
                  <text x="400" y="132">}</text>
                  <text x="36" y="164">Generate</text>
                  <text x="84" y="164">N1</text>
                  <text x="24" y="196">CTX_1</text>
                  <text x="56" y="196">=</text>
                  <text x="108" y="196">updateCtx(</text>
                  <text x="80" y="212">X1,</text>
                  <text x="80" y="228">N1,</text>
                  <text x="96" y="244">CTX_OLD</text>
                  <text x="136" y="244">)</text>
                  <text x="280" y="276">Request</text>
                  <text x="324" y="276">#1</text>
                  <text x="32" y="292">Protect</text>
                  <text x="84" y="292">with</text>
                  <text x="128" y="292">CTX_1</text>
                  <text x="468" y="292">/.well-known/kudos</text>
                  <text x="236" y="308">OSCORE</text>
                  <text x="272" y="308">{</text>
                  <text x="232" y="324">...</text>
                  <text x="224" y="340">d</text>
                  <text x="256" y="340">flag:</text>
                  <text x="288" y="340">1</text>
                  <text x="416" y="340">CTX_1</text>
                  <text x="448" y="340">=</text>
                  <text x="500" y="340">updateCtx(</text>
                  <text x="228" y="356">x:</text>
                  <text x="252" y="356">X1</text>
                  <text x="472" y="356">X1,</text>
                  <text x="244" y="372">nonce:</text>
                  <text x="284" y="372">N1</text>
                  <text x="472" y="372">N1,</text>
                  <text x="232" y="388">...</text>
                  <text x="488" y="388">CTX_OLD</text>
                  <text x="528" y="388">)</text>
                  <text x="236" y="404">kid:</text>
                  <text x="276" y="404">0x01</text>
                  <text x="216" y="420">}</text>
                  <text x="420" y="420">Verify</text>
                  <text x="468" y="420">with</text>
                  <text x="512" y="420">CTX_1</text>
                  <text x="248" y="436">Encrypted</text>
                  <text x="320" y="436">Payload</text>
                  <text x="360" y="436">{</text>
                  <text x="232" y="452">...</text>
                  <text x="428" y="452">Generate</text>
                  <text x="476" y="452">N2</text>
                  <text x="272" y="468">Recipient-ID:</text>
                  <text x="348" y="468">0x42</text>
                  <text x="232" y="484">...</text>
                  <text x="424" y="484">CTX_NEW</text>
                  <text x="464" y="484">=</text>
                  <text x="516" y="484">updateCtx(</text>
                  <text x="216" y="500">}</text>
                  <text x="524" y="500">Comb(X1,X2),</text>
                  <text x="524" y="516">Comb(N1,N2),</text>
                  <text x="504" y="532">CTX_OLD</text>
                  <text x="544" y="532">)</text>
                  <text x="284" y="564">Response</text>
                  <text x="332" y="564">#1</text>
                  <text x="424" y="580">Protect</text>
                  <text x="476" y="580">with</text>
                  <text x="528" y="580">CTX_NEW</text>
                  <text x="236" y="596">OSCORE</text>
                  <text x="272" y="596">{</text>
                  <text x="232" y="612">...</text>
                  <text x="32" y="628">CTX_NEW</text>
                  <text x="72" y="628">=</text>
                  <text x="124" y="628">updateCtx(</text>
                  <text x="248" y="628">Partial</text>
                  <text x="296" y="628">IV:</text>
                  <text x="320" y="628">0</text>
                  <text x="132" y="644">Comb(X1,X2),</text>
                  <text x="232" y="644">...</text>
                  <text x="132" y="660">Comb(N1,N2),</text>
                  <text x="112" y="676">CTX_OLD</text>
                  <text x="152" y="676">)</text>
                  <text x="224" y="676">d</text>
                  <text x="256" y="676">flag:</text>
                  <text x="288" y="676">1</text>
                  <text x="228" y="692">x:</text>
                  <text x="252" y="692">X2</text>
                  <text x="28" y="708">Verify</text>
                  <text x="76" y="708">with</text>
                  <text x="128" y="708">CTX_NEW</text>
                  <text x="244" y="708">nonce:</text>
                  <text x="284" y="708">N2</text>
                  <text x="232" y="724">...</text>
                  <text x="32" y="740">Discard</text>
                  <text x="96" y="740">CTX_OLD</text>
                  <text x="216" y="740">}</text>
                  <text x="248" y="756">Encrypted</text>
                  <text x="320" y="756">Payload</text>
                  <text x="360" y="756">{</text>
                  <text x="28" y="772">Update</text>
                  <text x="72" y="772">SID</text>
                  <text x="104" y="772">and</text>
                  <text x="232" y="772">...</text>
                  <text x="420" y="772">Update</text>
                  <text x="464" y="772">SID</text>
                  <text x="496" y="772">and</text>
                  <text x="16" y="788">RID</text>
                  <text x="44" y="788">in</text>
                  <text x="88" y="788">CTX_NEW</text>
                  <text x="272" y="788">Recipient-ID:</text>
                  <text x="348" y="788">0x78</text>
                  <text x="408" y="788">RID</text>
                  <text x="436" y="788">in</text>
                  <text x="480" y="788">CTX_NEW</text>
                  <text x="232" y="804">...</text>
                  <text x="32" y="820">CTX_NEW</text>
                  <text x="72" y="820">{</text>
                  <text x="216" y="820">}</text>
                  <text x="424" y="820">CTX_NEW</text>
                  <text x="464" y="820">{</text>
                  <text x="24" y="836">SID</text>
                  <text x="48" y="836">=</text>
                  <text x="76" y="836">0x78</text>
                  <text x="416" y="836">SID</text>
                  <text x="440" y="836">=</text>
                  <text x="468" y="836">0x42</text>
                  <text x="24" y="852">RID</text>
                  <text x="48" y="852">=</text>
                  <text x="76" y="852">0x42</text>
                  <text x="416" y="852">RID</text>
                  <text x="440" y="852">=</text>
                  <text x="468" y="852">0x78</text>
                  <text x="8" y="868">}</text>
                  <text x="400" y="868">}</text>
                  <text x="16" y="916">The</text>
                  <text x="60" y="916">actual</text>
                  <text x="104" y="916">key</text>
                  <text x="148" y="916">update</text>
                  <text x="208" y="916">process</text>
                  <text x="260" y="916">ends</text>
                  <text x="304" y="916">here.</text>
                  <text x="16" y="932">The</text>
                  <text x="48" y="932">two</text>
                  <text x="88" y="932">peers</text>
                  <text x="128" y="932">can</text>
                  <text x="160" y="932">use</text>
                  <text x="192" y="932">the</text>
                  <text x="224" y="932">new</text>
                  <text x="276" y="932">Security</text>
                  <text x="344" y="932">Context</text>
                  <text x="412" y="932">CTX_NEW.</text>
                  <text x="280" y="980">Request</text>
                  <text x="324" y="980">#2</text>
                  <text x="32" y="996">Protect</text>
                  <text x="84" y="996">with</text>
                  <text x="136" y="996">CTX_NEW</text>
                  <text x="416" y="996">/temp</text>
                  <text x="236" y="1012">OSCORE</text>
                  <text x="272" y="1012">{</text>
                  <text x="232" y="1028">...</text>
                  <text x="236" y="1044">kid:</text>
                  <text x="276" y="1044">0x78</text>
                  <text x="420" y="1044">Verify</text>
                  <text x="468" y="1044">with</text>
                  <text x="520" y="1044">CTX_NEW</text>
                  <text x="216" y="1060">}</text>
                  <text x="248" y="1076">Encrypted</text>
                  <text x="320" y="1076">Payload</text>
                  <text x="360" y="1076">{</text>
                  <text x="424" y="1076">Discard</text>
                  <text x="488" y="1076">CTX_OLD</text>
                  <text x="232" y="1092">...</text>
                  <text x="264" y="1108">Application</text>
                  <text x="344" y="1108">Payload</text>
                  <text x="216" y="1124">}</text>
                  <text x="284" y="1156">Response</text>
                  <text x="332" y="1156">#2</text>
                  <text x="424" y="1172">Protect</text>
                  <text x="476" y="1172">with</text>
                  <text x="528" y="1172">CTX_NEW</text>
                  <text x="236" y="1188">OSCORE</text>
                  <text x="272" y="1188">{</text>
                  <text x="232" y="1204">...</text>
                  <text x="28" y="1220">Verify</text>
                  <text x="76" y="1220">with</text>
                  <text x="128" y="1220">CTX_NEW</text>
                  <text x="216" y="1220">}</text>
                  <text x="248" y="1236">Encrypted</text>
                  <text x="320" y="1236">Payload</text>
                  <text x="360" y="1236">{</text>
                  <text x="232" y="1252">...</text>
                  <text x="264" y="1268">Application</text>
                  <text x="344" y="1268">Payload</text>
                  <text x="216" y="1284">}</text>
                </g>
              </svg><a href="#appendix-A.1-2.1.1" class="pilcrow">Â¶</a>
</div>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-example-of-the-oscore-id-upda" class="selfRef">Example of the OSCORE ID update procedure with Forward Message Flow and Integrated in a KUDOS Execution.</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="sec-id-update-in-kudos-reverse">
<section id="appendix-A.2">
        <h3 id="name-reverse-message-flow-2">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-reverse-message-flow-2" class="section-name selfRef">Reverse Message Flow</a>
        </h3>
<p id="appendix-A.2-1"><a href="#fig-kudos-and-id-update-server-init" class="auto internal xref">Figure 4</a> provides an example of the OSCORE ID update procedure, as run integrated in an execution of KUDOS and in the reverse message flow (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-key-update-10#section-4.3.6" class="relref">Section 4.3.6</a> of [<a href="#I-D.ietf-core-oscore-key-update" class="cite xref">I-D.ietf-core-oscore-key-update</a>]</span>). On each peer, SID and RID denote the OSCORE Sender ID and Recipient ID of that peer, respectively.<a href="#appendix-A.2-1" class="pilcrow">Â¶</a></p>
<span id="name-example-of-the-oscore-id-updat"></span><div id="fig-kudos-and-id-update-server-init">
<figure id="figure-4">
          <div id="appendix-A.2-2.1">
            <div class="alignCenter art-svg artwork" id="appendix-A.2-2.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="1680" width="576" viewBox="0 0 576 1680" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 200,64 L 200,1088" fill="none" stroke="black"></path>
                <path d="M 200,1168 L 200,1664" fill="none" stroke="black"></path>
                <path d="M 384,64 L 384,1088" fill="none" stroke="black"></path>
                <path d="M 384,1168 L 384,1664" fill="none" stroke="black"></path>
                <path d="M 208,176 L 376,176" fill="none" stroke="black"></path>
                <path d="M 208,400 L 376,400" fill="none" stroke="black"></path>
                <path d="M 208,688 L 376,688" fill="none" stroke="black"></path>
                <path d="M 208,1200 L 376,1200" fill="none" stroke="black"></path>
                <path d="M 208,1360 L 376,1360" fill="none" stroke="black"></path>
                <path d="M 208,1536 L 376,1536" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="384,1360 372,1354.4 372,1365.6" fill="black" transform="rotate(0,376,1360)"></polygon>
                <polygon class="arrowhead" points="384,688 372,682.4 372,693.6" fill="black" transform="rotate(0,376,688)"></polygon>
                <polygon class="arrowhead" points="384,176 372,170.4 372,181.6" fill="black" transform="rotate(0,376,176)"></polygon>
                <polygon class="arrowhead" points="216,1536 204,1530.4 204,1541.6" fill="black" transform="rotate(180,208,1536)"></polygon>
                <polygon class="arrowhead" points="216,1200 204,1194.4 204,1205.6" fill="black" transform="rotate(180,208,1200)"></polygon>
                <polygon class="arrowhead" points="216,400 204,394.4 204,405.6" fill="black" transform="rotate(180,208,400)"></polygon>
                <g class="text">
                  <text x="204" y="36">Client</text>
                  <text x="388" y="36">Server</text>
                  <text x="200" y="52">(responder)</text>
                  <text x="384" y="52">(initiator)</text>
                  <text x="32" y="84">CTX_OLD</text>
                  <text x="72" y="84">{</text>
                  <text x="424" y="84">CTX_OLD</text>
                  <text x="464" y="84">{</text>
                  <text x="24" y="100">SID</text>
                  <text x="48" y="100">=</text>
                  <text x="76" y="100">0x01</text>
                  <text x="416" y="100">SID</text>
                  <text x="440" y="100">=</text>
                  <text x="468" y="100">0x00</text>
                  <text x="24" y="116">RID</text>
                  <text x="48" y="116">=</text>
                  <text x="76" y="116">0x00</text>
                  <text x="416" y="116">RID</text>
                  <text x="440" y="116">=</text>
                  <text x="468" y="116">0x01</text>
                  <text x="8" y="132">}</text>
                  <text x="400" y="132">}</text>
                  <text x="280" y="164">Request</text>
                  <text x="324" y="164">#1</text>
                  <text x="32" y="180">Protect</text>
                  <text x="84" y="180">with</text>
                  <text x="136" y="180">CTX_OLD</text>
                  <text x="416" y="180">/temp</text>
                  <text x="236" y="196">OSCORE</text>
                  <text x="272" y="196">{</text>
                  <text x="232" y="212">...</text>
                  <text x="236" y="228">kid:</text>
                  <text x="276" y="228">0x01</text>
                  <text x="216" y="244">}</text>
                  <text x="420" y="244">Verify</text>
                  <text x="468" y="244">with</text>
                  <text x="520" y="244">CTX_OLD</text>
                  <text x="248" y="260">Encrypted</text>
                  <text x="320" y="260">Payload</text>
                  <text x="360" y="260">{</text>
                  <text x="232" y="276">...</text>
                  <text x="428" y="276">Generate</text>
                  <text x="476" y="276">N1</text>
                  <text x="264" y="292">Application</text>
                  <text x="344" y="292">Payload</text>
                  <text x="216" y="308">}</text>
                  <text x="416" y="308">CTX_1</text>
                  <text x="448" y="308">=</text>
                  <text x="500" y="308">updateCtx(</text>
                  <text x="472" y="324">X1,</text>
                  <text x="472" y="340">N1,</text>
                  <text x="488" y="356">CTX_OLD</text>
                  <text x="528" y="356">)</text>
                  <text x="284" y="388">Response</text>
                  <text x="332" y="388">#1</text>
                  <text x="424" y="404">Protect</text>
                  <text x="476" y="404">with</text>
                  <text x="520" y="404">CTX_1</text>
                  <text x="236" y="420">OSCORE</text>
                  <text x="272" y="420">{</text>
                  <text x="232" y="436">...</text>
                  <text x="24" y="452">CTX_1</text>
                  <text x="56" y="452">=</text>
                  <text x="108" y="452">updateCtx(</text>
                  <text x="248" y="452">Partial</text>
                  <text x="296" y="452">IV:</text>
                  <text x="320" y="452">0</text>
                  <text x="80" y="468">X1,</text>
                  <text x="232" y="468">...</text>
                  <text x="80" y="484">N1,</text>
                  <text x="224" y="484">d</text>
                  <text x="256" y="484">flag:</text>
                  <text x="288" y="484">1</text>
                  <text x="96" y="500">CTX_OLD</text>
                  <text x="136" y="500">)</text>
                  <text x="228" y="500">x:</text>
                  <text x="252" y="500">X1</text>
                  <text x="244" y="516">nonce:</text>
                  <text x="284" y="516">N1</text>
                  <text x="28" y="532">Verify</text>
                  <text x="76" y="532">with</text>
                  <text x="120" y="532">CTX_1</text>
                  <text x="232" y="532">...</text>
                  <text x="216" y="548">}</text>
                  <text x="36" y="564">Generate</text>
                  <text x="84" y="564">N2</text>
                  <text x="248" y="564">Encrypted</text>
                  <text x="320" y="564">Payload</text>
                  <text x="360" y="564">{</text>
                  <text x="232" y="580">...</text>
                  <text x="32" y="596">CTX_NEW</text>
                  <text x="72" y="596">=</text>
                  <text x="124" y="596">updateCtx(</text>
                  <text x="272" y="596">Recipient-ID:</text>
                  <text x="348" y="596">0x78</text>
                  <text x="132" y="612">Comb(X1,X2),</text>
                  <text x="232" y="612">...</text>
                  <text x="132" y="628">Comb(N1,N2),</text>
                  <text x="216" y="628">}</text>
                  <text x="112" y="644">CTX_OLD</text>
                  <text x="152" y="644">)</text>
                  <text x="280" y="676">Request</text>
                  <text x="324" y="676">#2</text>
                  <text x="32" y="692">Protect</text>
                  <text x="84" y="692">with</text>
                  <text x="136" y="692">CTX_NEW</text>
                  <text x="468" y="692">/.well-known/kudos</text>
                  <text x="236" y="708">OSCORE</text>
                  <text x="272" y="708">{</text>
                  <text x="232" y="724">...</text>
                  <text x="224" y="740">d</text>
                  <text x="256" y="740">flag:</text>
                  <text x="288" y="740">1</text>
                  <text x="424" y="740">CTX_NEW</text>
                  <text x="464" y="740">=</text>
                  <text x="516" y="740">updateCtx(</text>
                  <text x="228" y="756">x:</text>
                  <text x="252" y="756">X2</text>
                  <text x="524" y="756">Comb(X1,X2),</text>
                  <text x="244" y="772">nonce:</text>
                  <text x="284" y="772">N2</text>
                  <text x="524" y="772">Comb(N1,N2),</text>
                  <text x="228" y="788">y:</text>
                  <text x="248" y="788">w</text>
                  <text x="504" y="788">CTX_OLD</text>
                  <text x="544" y="788">)</text>
                  <text x="260" y="804">old_nonce:</text>
                  <text x="316" y="804">N1</text>
                  <text x="236" y="820">kid:</text>
                  <text x="276" y="820">0x01</text>
                  <text x="232" y="836">...</text>
                  <text x="216" y="852">}</text>
                  <text x="420" y="852">Verify</text>
                  <text x="468" y="852">with</text>
                  <text x="520" y="852">CTX_NEW</text>
                  <text x="248" y="868">Encrypted</text>
                  <text x="320" y="868">Payload</text>
                  <text x="360" y="868">{</text>
                  <text x="232" y="884">...</text>
                  <text x="424" y="884">Discard</text>
                  <text x="488" y="884">CTX_OLD</text>
                  <text x="272" y="900">Recipient-ID:</text>
                  <text x="348" y="900">0x42</text>
                  <text x="232" y="916">...</text>
                  <text x="264" y="932">Application</text>
                  <text x="344" y="932">Payload</text>
                  <text x="216" y="948">}</text>
                  <text x="28" y="980">Update</text>
                  <text x="72" y="980">SID</text>
                  <text x="104" y="980">and</text>
                  <text x="420" y="980">Update</text>
                  <text x="464" y="980">SID</text>
                  <text x="496" y="980">and</text>
                  <text x="16" y="996">RID</text>
                  <text x="44" y="996">in</text>
                  <text x="88" y="996">CTX_NEW</text>
                  <text x="408" y="996">RID</text>
                  <text x="436" y="996">in</text>
                  <text x="480" y="996">CTX_NEW</text>
                  <text x="40" y="1028">CTX_NEW</text>
                  <text x="80" y="1028">{</text>
                  <text x="424" y="1028">CTX_NEW</text>
                  <text x="464" y="1028">{</text>
                  <text x="32" y="1044">SID</text>
                  <text x="56" y="1044">=</text>
                  <text x="84" y="1044">0x78</text>
                  <text x="416" y="1044">SID</text>
                  <text x="440" y="1044">=</text>
                  <text x="468" y="1044">0x42</text>
                  <text x="32" y="1060">RID</text>
                  <text x="56" y="1060">=</text>
                  <text x="84" y="1060">0x42</text>
                  <text x="416" y="1060">RID</text>
                  <text x="440" y="1060">=</text>
                  <text x="468" y="1060">0x78</text>
                  <text x="16" y="1076">}</text>
                  <text x="400" y="1076">}</text>
                  <text x="16" y="1124">The</text>
                  <text x="60" y="1124">actual</text>
                  <text x="104" y="1124">key</text>
                  <text x="148" y="1124">update</text>
                  <text x="208" y="1124">process</text>
                  <text x="260" y="1124">ends</text>
                  <text x="304" y="1124">here.</text>
                  <text x="16" y="1140">The</text>
                  <text x="48" y="1140">two</text>
                  <text x="88" y="1140">peers</text>
                  <text x="128" y="1140">can</text>
                  <text x="160" y="1140">use</text>
                  <text x="192" y="1140">the</text>
                  <text x="224" y="1140">new</text>
                  <text x="276" y="1140">Security</text>
                  <text x="344" y="1140">Context</text>
                  <text x="412" y="1140">CTX_NEW.</text>
                  <text x="284" y="1188">Response</text>
                  <text x="332" y="1188">#2</text>
                  <text x="424" y="1204">Protect</text>
                  <text x="476" y="1204">with</text>
                  <text x="528" y="1204">CTX_NEW</text>
                  <text x="236" y="1220">OSCORE</text>
                  <text x="272" y="1220">{</text>
                  <text x="232" y="1236">...</text>
                  <text x="28" y="1252">Verify</text>
                  <text x="76" y="1252">with</text>
                  <text x="128" y="1252">CTX_NEW</text>
                  <text x="216" y="1252">}</text>
                  <text x="248" y="1268">Encrypted</text>
                  <text x="320" y="1268">Payload</text>
                  <text x="360" y="1268">{</text>
                  <text x="32" y="1284">Discard</text>
                  <text x="96" y="1284">CTX_OLD</text>
                  <text x="232" y="1284">...</text>
                  <text x="264" y="1300">Application</text>
                  <text x="344" y="1300">Payload</text>
                  <text x="216" y="1316">}</text>
                  <text x="280" y="1348">Request</text>
                  <text x="324" y="1348">#3</text>
                  <text x="32" y="1364">Protect</text>
                  <text x="84" y="1364">with</text>
                  <text x="136" y="1364">CTX_NEW</text>
                  <text x="416" y="1364">/temp</text>
                  <text x="236" y="1380">OSCORE</text>
                  <text x="272" y="1380">{</text>
                  <text x="232" y="1396">...</text>
                  <text x="236" y="1412">kid:</text>
                  <text x="276" y="1412">0x78</text>
                  <text x="420" y="1412">Verify</text>
                  <text x="468" y="1412">with</text>
                  <text x="520" y="1412">CTX_NEW</text>
                  <text x="216" y="1428">}</text>
                  <text x="248" y="1444">Encrypted</text>
                  <text x="320" y="1444">Payload</text>
                  <text x="360" y="1444">{</text>
                  <text x="232" y="1460">...</text>
                  <text x="264" y="1476">Application</text>
                  <text x="344" y="1476">Payload</text>
                  <text x="216" y="1492">}</text>
                  <text x="284" y="1524">Response</text>
                  <text x="332" y="1524">#3</text>
                  <text x="424" y="1540">Protect</text>
                  <text x="476" y="1540">with</text>
                  <text x="528" y="1540">CTX_NEW</text>
                  <text x="236" y="1556">OSCORE</text>
                  <text x="272" y="1556">{</text>
                  <text x="232" y="1572">...</text>
                  <text x="28" y="1588">Verify</text>
                  <text x="76" y="1588">with</text>
                  <text x="128" y="1588">CTX_NEW</text>
                  <text x="216" y="1588">}</text>
                  <text x="248" y="1604">Encrypted</text>
                  <text x="320" y="1604">Payload</text>
                  <text x="360" y="1604">{</text>
                  <text x="232" y="1620">...</text>
                  <text x="264" y="1636">Application</text>
                  <text x="344" y="1636">Payload</text>
                  <text x="216" y="1652">}</text>
                </g>
              </svg><a href="#appendix-A.2-2.1.1" class="pilcrow">Â¶</a>
</div>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-example-of-the-oscore-id-updat" class="selfRef">Example of the OSCORE ID update procedure with Reverse Message Flow and Integrated in a KUDOS Execution.</a>
          </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="sec-document-updates">
<section id="appendix-B">
      <h2 id="name-document-updates">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-document-updates" class="section-name selfRef">Document Updates</a>
      </h2>
<p id="appendix-B-1">This section is to be removed before publishing as an RFC.<a href="#appendix-B-1" class="pilcrow">Â¶</a></p>
<div id="sec-02-03">
<section id="appendix-B.1">
        <h3 id="name-version-02-to-03">
<a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-version-02-to-03" class="section-name selfRef">Version -02 to -03</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-B.1-1.1">
            <p id="appendix-B.1-1.1.1">Editorial improvements.<a href="#appendix-B.1-1.1.1" class="pilcrow">Â¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-01-02">
<section id="appendix-B.2">
        <h3 id="name-version-01-to-02">
<a href="#appendix-B.2" class="section-number selfRef">B.2. </a><a href="#name-version-01-to-02" class="section-name selfRef">Version -01 to -02</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-B.2-1.1">
            <p id="appendix-B.2-1.1.1">Split long section into subsections.<a href="#appendix-B.2-1.1.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-1.2">
            <p id="appendix-B.2-1.2.1">Updated references.<a href="#appendix-B.2-1.2.1" class="pilcrow">Â¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-00-01">
<section id="appendix-B.3">
        <h3 id="name-version-00-to-01">
<a href="#appendix-B.3" class="section-number selfRef">B.3. </a><a href="#name-version-00-to-01" class="section-name selfRef">Version -00 to -01</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-B.3-1.1">
            <p id="appendix-B.3-1.1.1">Revised and extended error handling.<a href="#appendix-B.3-1.1.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="appendix-B.3-1.2">
            <p id="appendix-B.3-1.2.1">Specify that the Recipient-ID option may need to be empty.<a href="#appendix-B.3-1.2.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="appendix-B.3-1.3">
            <p id="appendix-B.3-1.3.1">Failure cases when running the ID update procedure integrated with KUDOS.<a href="#appendix-B.3-1.3.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="appendix-B.3-1.4">
            <p id="appendix-B.3-1.4.1">Clarifications and editorial improvements.<a href="#appendix-B.3-1.4.1" class="pilcrow">Â¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-00">
<section id="appendix-B.4">
        <h3 id="name-version-00">
<a href="#appendix-B.4" class="section-number selfRef">B.4. </a><a href="#name-version-00" class="section-name selfRef">Version -00</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-B.4-1.1">
            <p id="appendix-B.4-1.1.1">Split out material from Key Update for OSCORE draft into this new document.<a href="#appendix-B.4-1.1.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="appendix-B.4-1.2">
            <p id="appendix-B.4-1.2.1">Extended terminology.<a href="#appendix-B.4-1.2.1" class="pilcrow">Â¶</a></p>
</li>
          <li class="normal" id="appendix-B.4-1.3">
            <p id="appendix-B.4-1.3.1">Editorial improvements.<a href="#appendix-B.4-1.3.1" class="pilcrow">Â¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="acknowledgment">
<section id="appendix-C">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-C-1">The authors sincerely thank <span class="contact-name">Christian AmsÃ¼ss</span>, <span class="contact-name">Carsten Bormann</span>, <span class="contact-name">John PreuÃ Mattsson</span>, and <span class="contact-name">GÃ¶ran Selander</span> for their feedback and comments.<a href="#appendix-C-1" class="pilcrow">Â¶</a></p>
<p id="appendix-C-2">The work on this document has been partly supported by VINNOVA and the Celtic-Next projects CRITISEC and CYPRESS; and by the H2020 projects SIFIS-Home (Grant agreement 952652) and ARCADIAN-IoT (Grant agreement 101020259).<a href="#appendix-C-2" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-D">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Rikard HÃ¶glund</span></div>
<div dir="auto" class="left"><span class="org">RISE AB</span></div>
<div dir="auto" class="left"><span class="street-address">Isafjordsgatan 22</span></div>
<div dir="auto" class="left">SE-<span class="postal-code">16440 Stockholm</span> <span class="locality">Kista</span>
</div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:rikard.hoglund@ri.se" class="email">rikard.hoglund@ri.se</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Marco Tiloca</span></div>
<div dir="auto" class="left"><span class="org">RISE AB</span></div>
<div dir="auto" class="left"><span class="street-address">Isafjordsgatan 22</span></div>
<div dir="auto" class="left">SE-<span class="postal-code">16440 Stockholm</span> <span class="locality">Kista</span>
</div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:marco.tiloca@ri.se" class="email">marco.tiloca@ri.se</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
